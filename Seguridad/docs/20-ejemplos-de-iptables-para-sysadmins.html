<!DOCTYPE html><html class="no-js" dir="ltr" lang="es-ES" xmlns:og="http://opengraphprotocol.org/schema/"><head><link rel="profile" href="http://gmpg.org/xfn/11" /><meta charset="UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><title>20 ejemplos de iptables para SysAdmins novatos &laquo; El Baúl del Programador</title><link rel="canonical" href="http://www.elbauldelprogramador.com/noticias/linux/20-ejemplos-de-iptables-para-sysadmins/" /><link rel="author" href="117030001562039350135"/><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@elbaulp"><meta name="twitter:creator" content="@elbaulp"><meta name="twitter:description" content="Linux por defecto trae un cortafuegos llamado NetFilter. Según el sitio oficil de proyecto: netfiltes es un conjunto de hooks (Ganchos) dentro del kernel de linux que permiten a los módulos del kernel registrar funciones callbacks con la pila de red. Una función callback registrada se llama entonces para cada paquete que atraviesa el hook&hellip; Continue reading &rarr;"><meta property='og:locale' content='es_es'/><meta property='fb:admins' content='100000278089852'/><meta property='og:title' content='20 ejemplos de iptables para SysAdmins novatos - El Baúl del Programador'/><meta property='og:url' content='http://www.elbauldelprogramador.com/noticias/linux/20-ejemplos-de-iptables-para-sysadmins/'/><meta property='og:site_name' content='El Baúl del Programador'/><meta property='og:type' content='article'/><meta property='og:image' content='http://3.bp.blogspot.com/-_5WvmCXMYjk/TvTkTNhQPUI/AAAAAAAAB88/VP8jxCu5y3A/s320/Applic-Firewall-icon.png'/><link rel="alternate" type="application/rss+xml" title="El Baúl del Programador &raquo; Feed" href="http://www.elbauldelprogramador.com/feed/" /><link rel="alternate" type="application/rss+xml" title="El Baúl del Programador &raquo; RSS de los comentarios" href="http://www.elbauldelprogramador.com/comments/feed/" /><script type="text/javascript">var _gaq=_gaq||[];_gaq.push(['_setAccount','UA-19017085-2']);_gaq.push(['_setCustomVar',2,'author','alejandro-alcalde',3],['_setCustomVar',4,'category','aplicaciones',3],['_trackPageview']);(function(){var ga=document.createElement('script');ga.type='text/javascript';ga.async=true;ga.src=('https:'==document.location.protocol?'https://ssl':'http://www')+'.google-analytics.com/ga.js';var s=document.getElementsByTagName('script')[0];s.parentNode.insertBefore(ga,s);})();</script><link rel="alternate" type="application/rss+xml" title="El Baúl del Programador &raquo; 20 ejemplos de iptables para SysAdmins novatos RSS de los comentarios" href="http://www.elbauldelprogramador.com/noticias/linux/20-ejemplos-de-iptables-para-sysadmins/feed/" /><link rel='stylesheet' id='jetpack-widgets-css'  href='http://www.elbauldelprogramador.com/wp-content/plugins/jetpack/modules/widgets/widgets.css?ver=20120924' type='text/css' media='all' /><link rel='stylesheet' id='tw-bootstrap-css'  href='http://www.elbauldelprogramador.com/wp-content/themes/the-bootstrap/css/bootstrap.min.css?ver=2.0.3' type='text/css' media='all' /><link rel='stylesheet' id='the-bootstrap-css'  href='http://www.elbauldelprogramador.com/wp-content/themes/the-bootstrap/style.min.css?ver=6986' type='text/css' media='all' /><style type='text/css'>body > .container{margin-top:68px}@mediamin-width 980px{body > .container{margin-top:58px}}</style><link rel='stylesheet' id='the-bootstrap-child-css'  href='http://www.elbauldelprogramador.com/wp-content/themes/the-bootstrap-child/style.css?ver=6986' type='text/css' media='all' /><link rel='stylesheet' id='sharedaddy-css'  href='http://www.elbauldelprogramador.com/wp-content/plugins/jetpack/modules/sharedaddy/sharing.css?ver=0.3.1' type='text/css' media='all' /><link rel='stylesheet' id='wp_dlmp_styles-css'  href='http://www.elbauldelprogramador.com/wp-content/plugins/download-monitor/page-addon/styles.css?ver=6986' type='text/css' media='all' /><link rel='stylesheet' id='wp-syntax-css-css'  href='http://www.elbauldelprogramador.com/wp-content/plugins/wp-syntax/wp-syntax.css?ver=6986' type='text/css' media='all' /><script type='text/javascript' src='http://www.elbauldelprogramador.com/wp-includes/js/jquery/jquery.js?ver=1.7.2'></script><link rel='shortlink' href='http://wp.me/p2kdv9-54' /><style type='text/css'>.download-info .download-button{background-image:url(http://www.elbauldelprogramador.com/wp-content/plugins/download-monitor/page-addon/downloadbutton.gif)}.download-info .more-button{background-image:url(http://www.elbauldelprogramador.com/wp-content/plugins/download-monitor/page-addon/morebutton.gif)}</style><style type="text/css" id="custom-background-css">body.custom-background{background-color:#EFEFEF}</style><!--[if lt IE 9]><script src="http://www.elbauldelprogramador.com/wp-content/themes/the-bootstrap/js/html5shiv.min.js" type="text/javascript"></script><script src="http://www.elbauldelprogramador.com/wp-content/themes/the-bootstrap/js/respond.min.js" type="text/javascript"></script><![endif]--></head><body class="single single-post postid-314 single-format-standard custom-background content-sidebar"><div class="container"><div id="page" class="hfeed row"> <header id="branding" role="banner" class="span12"> <hgroup><h1 id="site-title"> <a href="http://www.elbauldelprogramador.com/" title="El Baúl del Programador" rel="home"> <span>El Baúl del Programador</span> </a></h1> </hgroup> <nav id="access" role="navigation"><h3 class="assistive-text">Main menu</h3><div class="skip-link"><a class="assistive-text" href="#content" title="Skip to primary content">Skip to primary content</a></div><div class="skip-link"><a class="assistive-text" href="#secondary" title="Skip to secondary content">Skip to secondary content</a></div><div class="navbar navbar-fixed-top"><div class="navbar-inner"><div class="container"> <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse"> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </a><div class="nav-collapse"><div class="menu-programacion-2-container"><ul id="menu-programacion-2" class="nav"><li id="menu-item-420" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-420"><a title="Curso Programación Android" rel="section" href="http://www.elbauldelprogramador.com/curso-programacion-android/" >Android</a></li><li id="menu-item-500" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-500"><a title="Manuales de c++ y java" rel="section" href="http://www.elbauldelprogramador.com/c-y-java/" >C++ y Java</a></li><li id="menu-item-428" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-428"><a title="Curso Base de datos" rel="section" href="http://www.elbauldelprogramador.com/bases-de-datos/" >Bases de Datos</a></li><li id="menu-item-452" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-452"><a title="Descargar manuales gratuitos" rel="section" href="http://www.elbauldelprogramador.com/manuales-gratuitos/" >Manuales</a></li><li id="menu-item-671" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-671"><a title="Fundamentos del Software" rel="section" href="http://www.elbauldelprogramador.com/fundamentos-del-software/" >Fundamentos del Software</a></li><li id="menu-item-521" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-521"><a rel="section" href="http://www.elbauldelprogramador.com/seccion-de-descargas/" >Descargas</a></li><li id="menu-item-538" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-538"><a href="http://www.elbauldelprogramador.com/programacion/script/" >Scripts</a></li><li id="menu-item-798" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-798"><a title="Índice de todas las entradas" rel="section" href="http://www.elbauldelprogramador.com/indice-de-todas-las-del-blog/" >Índice</a></li><li id="menu-item-768" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-768"><a href="http://www.elbauldelprogramador.com/contacto/" >Contacto</a></li></ul></div><form id="searchform" class="navbar-search pull-right" method="get" action="http://www.elbauldelprogramador.com/"> <label for="s" class="assistive-text hidden">Search</label> <input type="search" class="search-query" name="s" id="s" placeholder="Search" /></form></div></div></div></div> </nav> <nav id="breadcrumb" class="breadcrumb"><span xmlns:v="http://rdf.data-vocabulary.org/#"><span typeof="v:Breadcrumb"><a href="http://www.elbauldelprogramador.com" rel="v:url" property="v:title">Portada</a></span> ›› <span typeof="v:Breadcrumb"><a href="http://www.elbauldelprogramador.com/opensource/" rel="v:url" property="v:title">opensource</a></span> ›› <span typeof="v:Breadcrumb"><a href="http://www.elbauldelprogramador.com/opensource/aplicaciones/" rel="v:url" property="v:title">aplicaciones</a></span> ›› <span typeof="v:Breadcrumb"><strong class="breadcrumb_last" property="v:title">20 ejemplos de iptables para SysAdmins novatos</strong></span></span></nav> </header> <section id="primary" class="span8"><div id="content" role="main"> <article id="post-314" class="post-314 post type-post status-publish format-standard hentry category-aplicaciones category-internet category-linux category-seguridad"> <header class="page-header"><h1 class="entry-title">20 ejemplos de iptables para SysAdmins novatos</h1><div class="entry-meta"><span class="sep">Posted on </span><a href="http://www.elbauldelprogramador.com/noticias/linux/20-ejemplos-de-iptables-para-sysadmins/" title="22:32" rel="bookmark"><time class="entry-date" datetime="2011-12-23T22:32:00+00:00" pubdate>23 diciembre, 2011</time></a><span class="by-author"> <span class="sep"> by </span> <span class="author vcard"><a class="url fn n" href="http://www.elbauldelprogramador.com/author/algui91/" title="View all posts by Alejandro Alcalde" rel="author">Alejandro Alcalde</a> </span></span> <span class="sep"> | </span> <span class="comments-link"> <a href="http://www.elbauldelprogramador.com/noticias/linux/20-ejemplos-de-iptables-para-sysadmins/#comments" title="Comentarios en 20 ejemplos de iptables para SysAdmins novatos"><strong>2</strong> Replies</a> </span> <br /><span style="font-size:x-small"><a href="http://www.elbauldelprogramador.com/noticias/cursos/nueva-guia-think-different-how-to-build/" rel="next">Nueva guía &#8211; Think Different: How to Build Your Own Hackintosh <span class="meta-nav">&rarr;</span></a></span> <span style="font-size:x-small"><a href="http://www.elbauldelprogramador.com/programacion/programacion-android-insertando/" rel="prev"><span class="meta-nav">&larr;</span> Programación Android: Insertando registros</a></span></div> </header><a target="_blank" href="http://bitacoras.com/anotaciones/www.elbauldelprogramador.com/noticias/linux/20-ejemplos-de-iptables-para-sysadmins/"><img src="http://widgets.bitacoras.com/votar/mini/www.elbauldelprogramador.com/noticias/linux/20-ejemplos-de-iptables-para-sysadmins/" alt="votar" title="Votar esta anotacion en Bitacoras.com" style="vertical-align:middle;border:0" /></a><br /><br /><div class="entry-content clearfix"><div class="separator" style="clear: both; float:left; text-align: center;"> <a href="http://3.bp.blogspot.com/-_5WvmCXMYjk/TvTkTNhQPUI/AAAAAAAAB88/VP8jxCu5y3A/s1600/Applic-Firewall-icon.png" onclick="javascript:_gaq.push(['_trackEvent','outbound-article','http://3.bp.blogspot.com/-_5WvmCXMYjk/TvTkTNhQPUI/AAAAAAAAB88/VP8jxCu5y3A/s1600/Applic-Firewall-icon.png']);" imageanchor="1" style="clear:left; float:left;margin-right:1em; margin-bottom:1em"><img border="0" height="128" width="128" src="http://3.bp.blogspot.com/-_5WvmCXMYjk/TvTkTNhQPUI/AAAAAAAAB88/VP8jxCu5y3A/s320/Applic-Firewall-icon.png" /></a></div><p>Linux por defecto trae un cortafuegos llamado NetFilter. Según el sitio oficil de proyecto:</p><div style="text-align:center"><blockquote><p>netfiltes es un conjunto de hooks (Ganchos) dentro del kernel de linux que permiten a los módulos del kernel registrar funciones callbacks con la pila de red. Una función callback registrada se llama entonces para cada paquete que atraviesa el hook correspondiente dentro de la pila de red.</p></blockquote></div><p>Este firewall lo controla un programa llamado iptables que gestiona el filtrado para IPv4, y ip6tables para IPv6.</p><h2>Ejemplos de reglas IPTABLES</h2><ul><li>Muchas de las acciones que se listan abajo requieren ejecutarse como usuario root.</li><li>Los siguientes comandos deberían funcionar en cualquier distro linux moderna.</li><li>Esto NO es un tutorial de como configurar iptables. Puedes ver un tutorial <a target="_blank" href="http://www.cyberciti.biz/faq/rhel-fedorta-linux-iptables-firewall-configuration-tutorial/" onclick="javascript:_gaq.push(['_trackEvent','outbound-article','http://www.cyberciti.biz/faq/rhel-fedorta-linux-iptables-firewall-configuration-tutorial/']);">aquí</a>. Es más bien una referencia rápida de los comandos más comunes de iptables.</li></ul><p><span id="more-314"></span></p><h1>#1: Mostrando el estado de nuestro firewall</h1><p>Teclea el siguiente comando como root:</p><div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;">iptables <span style="color: #660033;">-L</span> <span style="color: #660033;">-n</span> <span style="color: #660033;">-v</span></pre></td></tr></table></div><p>Ejemplos de salidas:</p><div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;">Chain INPUT <span style="color: #7a0874; font-weight: bold;">&#40;</span>policy ACCEPT <span style="color: #000000;">0</span> packets, <span style="color: #000000;">0</span> bytes<span style="color: #7a0874; font-weight: bold;">&#41;</span>
 pkts bytes target     prot opt <span style="color: #000000; font-weight: bold;">in</span>     out     <span style="color: #7a0874; font-weight: bold;">source</span>               destination
Chain FORWARD <span style="color: #7a0874; font-weight: bold;">&#40;</span>policy ACCEPT <span style="color: #000000;">0</span> packets, <span style="color: #000000;">0</span> bytes<span style="color: #7a0874; font-weight: bold;">&#41;</span>
 pkts bytes target     prot opt <span style="color: #000000; font-weight: bold;">in</span>     out     <span style="color: #7a0874; font-weight: bold;">source</span>               destination
Chain OUTPUT <span style="color: #7a0874; font-weight: bold;">&#40;</span>policy ACCEPT <span style="color: #000000;">0</span> packets, <span style="color: #000000;">0</span> bytes<span style="color: #7a0874; font-weight: bold;">&#41;</span>
 pkts bytes target     prot opt <span style="color: #000000; font-weight: bold;">in</span>     out     <span style="color: #7a0874; font-weight: bold;">source</span>               destination</pre></td></tr></table></div><p>El resultado de arriba indica que el firewall no está activo. La siguiente salida es la del firewall activado:</p><div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;">Chain INPUT <span style="color: #7a0874; font-weight: bold;">&#40;</span>policy DROP <span style="color: #000000;">0</span> packets, <span style="color: #000000;">0</span> bytes<span style="color: #7a0874; font-weight: bold;">&#41;</span>
 pkts bytes target     prot opt <span style="color: #000000; font-weight: bold;">in</span>     out     <span style="color: #7a0874; font-weight: bold;">source</span>               destination
    <span style="color: #000000;">0</span>     <span style="color: #000000;">0</span> DROP       all  <span style="color: #660033;">--</span>  <span style="color: #000000; font-weight: bold;">*</span>      <span style="color: #000000; font-weight: bold;">*</span>       0.0.0.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">0</span>            0.0.0.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">0</span>           state INVALID
  <span style="color: #000000;">394</span> <span style="color: #000000;">43586</span> ACCEPT     all  <span style="color: #660033;">--</span>  <span style="color: #000000; font-weight: bold;">*</span>      <span style="color: #000000; font-weight: bold;">*</span>       0.0.0.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">0</span>            0.0.0.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">0</span>           state RELATED,ESTABLISHED
   <span style="color: #000000;">93</span> <span style="color: #000000;">17292</span> ACCEPT     all  <span style="color: #660033;">--</span>  br0    <span style="color: #000000; font-weight: bold;">*</span>       0.0.0.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">0</span>            0.0.0.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">0</span>
    <span style="color: #000000;">1</span>   <span style="color: #000000;">142</span> ACCEPT     all  <span style="color: #660033;">--</span>  lo     <span style="color: #000000; font-weight: bold;">*</span>       0.0.0.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">0</span>            0.0.0.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">0</span>
Chain FORWARD <span style="color: #7a0874; font-weight: bold;">&#40;</span>policy DROP <span style="color: #000000;">0</span> packets, <span style="color: #000000;">0</span> bytes<span style="color: #7a0874; font-weight: bold;">&#41;</span>
 pkts bytes target     prot opt <span style="color: #000000; font-weight: bold;">in</span>     out     <span style="color: #7a0874; font-weight: bold;">source</span>               destination
    <span style="color: #000000;">0</span>     <span style="color: #000000;">0</span> ACCEPT     all  <span style="color: #660033;">--</span>  br0    br0     0.0.0.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">0</span>            0.0.0.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">0</span>
    <span style="color: #000000;">0</span>     <span style="color: #000000;">0</span> DROP       all  <span style="color: #660033;">--</span>  <span style="color: #000000; font-weight: bold;">*</span>      <span style="color: #000000; font-weight: bold;">*</span>       0.0.0.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">0</span>            0.0.0.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">0</span>           state INVALID
    <span style="color: #000000;">0</span>     <span style="color: #000000;">0</span> TCPMSS     tcp  <span style="color: #660033;">--</span>  <span style="color: #000000; font-weight: bold;">*</span>      <span style="color: #000000; font-weight: bold;">*</span>       0.0.0.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">0</span>            0.0.0.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">0</span>           tcp flags:0x06<span style="color: #000000; font-weight: bold;">/</span>0x02 TCPMSS clamp to PMTU
    <span style="color: #000000;">0</span>     <span style="color: #000000;">0</span> ACCEPT     all  <span style="color: #660033;">--</span>  <span style="color: #000000; font-weight: bold;">*</span>      <span style="color: #000000; font-weight: bold;">*</span>       0.0.0.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">0</span>            0.0.0.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">0</span>           state RELATED,ESTABLISHED
    <span style="color: #000000;">0</span>     <span style="color: #000000;">0</span> wanin      all  <span style="color: #660033;">--</span>  vlan2  <span style="color: #000000; font-weight: bold;">*</span>       0.0.0.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">0</span>            0.0.0.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">0</span>
    <span style="color: #000000;">0</span>     <span style="color: #000000;">0</span> wanout     all  <span style="color: #660033;">--</span>  <span style="color: #000000; font-weight: bold;">*</span>      vlan2   0.0.0.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">0</span>            0.0.0.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">0</span>
    <span style="color: #000000;">0</span>     <span style="color: #000000;">0</span> ACCEPT     all  <span style="color: #660033;">--</span>  br0    <span style="color: #000000; font-weight: bold;">*</span>       0.0.0.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">0</span>            0.0.0.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">0</span>
Chain OUTPUT <span style="color: #7a0874; font-weight: bold;">&#40;</span>policy ACCEPT <span style="color: #000000;">425</span> packets, 113K bytes<span style="color: #7a0874; font-weight: bold;">&#41;</span>
 pkts bytes target     prot opt <span style="color: #000000; font-weight: bold;">in</span>     out     <span style="color: #7a0874; font-weight: bold;">source</span>               destination
Chain wanin <span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #000000;">1</span> references<span style="color: #7a0874; font-weight: bold;">&#41;</span>
 pkts bytes target     prot opt <span style="color: #000000; font-weight: bold;">in</span>     out     <span style="color: #7a0874; font-weight: bold;">source</span>               destination
Chain wanout <span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #000000;">1</span> references<span style="color: #7a0874; font-weight: bold;">&#41;</span>
 pkts bytes target     prot opt <span style="color: #000000; font-weight: bold;">in</span>     out     <span style="color: #7a0874; font-weight: bold;">source</span>               destination</pre></td></tr></table></div><p>Donde,</p><ul><li><b>-L</b> : Muestra las reglas.</li><li><b>-v</b> : Muestra información detallada.</li><li><b>-n</b> : Muestra la dirección ip y puerto en formato numérico. No usa DNS para resolver nombres. Esto acelera la lista.</li></ul><h4>#1.1:Para Inspeccionar el firewall con número de lineas:</h4><div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;">iptables <span style="color: #660033;">-n</span> <span style="color: #660033;">-L</span> <span style="color: #660033;">-v</span> <span style="color: #660033;">--line-numbers</span></pre></td></tr></table></div><p>Salida:</p><div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;">Chain INPUT <span style="color: #7a0874; font-weight: bold;">&#40;</span>policy DROP<span style="color: #7a0874; font-weight: bold;">&#41;</span>
num  target     prot opt <span style="color: #7a0874; font-weight: bold;">source</span>               destination
<span style="color: #000000;">1</span>    DROP       all  <span style="color: #660033;">--</span>  0.0.0.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">0</span>            0.0.0.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">0</span>           state INVALID
<span style="color: #000000;">2</span>    ACCEPT     all  <span style="color: #660033;">--</span>  0.0.0.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">0</span>            0.0.0.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">0</span>           state RELATED,ESTABLISHED
<span style="color: #000000;">3</span>    ACCEPT     all  <span style="color: #660033;">--</span>  0.0.0.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">0</span>            0.0.0.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">0</span>
<span style="color: #000000;">4</span>    ACCEPT     all  <span style="color: #660033;">--</span>  0.0.0.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">0</span>            0.0.0.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">0</span>
Chain FORWARD <span style="color: #7a0874; font-weight: bold;">&#40;</span>policy DROP<span style="color: #7a0874; font-weight: bold;">&#41;</span>
num  target     prot opt <span style="color: #7a0874; font-weight: bold;">source</span>               destination
<span style="color: #000000;">1</span>    ACCEPT     all  <span style="color: #660033;">--</span>  0.0.0.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">0</span>            0.0.0.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">0</span>
<span style="color: #000000;">2</span>    DROP       all  <span style="color: #660033;">--</span>  0.0.0.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">0</span>            0.0.0.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">0</span>           state INVALID
<span style="color: #000000;">3</span>    TCPMSS     tcp  <span style="color: #660033;">--</span>  0.0.0.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">0</span>            0.0.0.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">0</span>           tcp flags:0x06<span style="color: #000000; font-weight: bold;">/</span>0x02 TCPMSS clamp to PMTU
<span style="color: #000000;">4</span>    ACCEPT     all  <span style="color: #660033;">--</span>  0.0.0.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">0</span>            0.0.0.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">0</span>           state RELATED,ESTABLISHED
<span style="color: #000000;">5</span>    wanin      all  <span style="color: #660033;">--</span>  0.0.0.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">0</span>            0.0.0.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">0</span>
<span style="color: #000000;">6</span>    wanout     all  <span style="color: #660033;">--</span>  0.0.0.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">0</span>            0.0.0.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">0</span>
<span style="color: #000000;">7</span>    ACCEPT     all  <span style="color: #660033;">--</span>  0.0.0.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">0</span>            0.0.0.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">0</span>
Chain OUTPUT <span style="color: #7a0874; font-weight: bold;">&#40;</span>policy ACCEPT<span style="color: #7a0874; font-weight: bold;">&#41;</span>
num  target     prot opt <span style="color: #7a0874; font-weight: bold;">source</span>               destination
Chain wanin <span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #000000;">1</span> references<span style="color: #7a0874; font-weight: bold;">&#41;</span>
num  target     prot opt <span style="color: #7a0874; font-weight: bold;">source</span>               destination
Chain wanout <span style="color: #7a0874; font-weight: bold;">&#40;</span><span style="color: #000000;">1</span> references<span style="color: #7a0874; font-weight: bold;">&#41;</span>
num  target     prot opt <span style="color: #7a0874; font-weight: bold;">source</span>               destination</pre></td></tr></table></div><p>Podemos usar los números de línea para borrar o añadir nuevas reglas al firewall.</p><h4>#1.2: Mostrar las reglas de cadena de entrada y salida:</h4><div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;">iptables <span style="color: #660033;">-L</span> INPUT <span style="color: #660033;">-n</span> <span style="color: #660033;">-v</span>
iptables <span style="color: #660033;">-L</span> OUTPUT <span style="color: #660033;">-n</span> <span style="color: #660033;">-v</span> <span style="color: #660033;">--line-numbers</span></pre></td></tr></table></div><h1>#2: Parar / Iniciar / Reiniciar el firewall</h1><p>Si usas CentOS / RHEL / Fedora linux:</p><div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;">service iptables stop
service iptables start
service iptables restart</pre></td></tr></table></div><p>También se puede usar propio comando iptables para detenerlo y borrar todas las reglas.</p><div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;">iptables <span style="color: #660033;">-F</span>
iptables <span style="color: #660033;">-X</span>
iptables <span style="color: #660033;">-t</span> nat <span style="color: #660033;">-F</span>
iptables <span style="color: #660033;">-t</span> nat <span style="color: #660033;">-X</span>
iptables <span style="color: #660033;">-t</span> mangle <span style="color: #660033;">-F</span>
iptables <span style="color: #660033;">-t</span> mangle <span style="color: #660033;">-X</span>
iptables <span style="color: #660033;">-P</span> INPUT ACCEPT
iptables <span style="color: #660033;">-P</span> OUTPUT ACCEPT
iptables <span style="color: #660033;">-P</span> FORWARD ACCEPT</pre></td></tr></table></div><p>Donde:</p><ul><li><b>-F</b> : Borra todas las reglas.</li><li><b>-X</b> : Borra cadenas</li><li><b>-t table_name</b> : Selecciona una tabla y elimina reglas</li><li><b>-P</b> : Establece la política por defecto (como DROP, REJECT o ACCEPT)</li></ul><h1>#3: Borrar reglas del firewall</h1><p>Para mostrar los números de línea junto a otra información para reglas existentes:</p><div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;">iptables <span style="color: #660033;">-L</span> INPUT <span style="color: #660033;">-n</span> <span style="color: #660033;">--line-numbers</span>
iptables <span style="color: #660033;">-L</span> OUTPUT <span style="color: #660033;">-n</span> <span style="color: #660033;">--line-numbers</span>
iptables <span style="color: #660033;">-L</span> OUTPUT <span style="color: #660033;">-n</span> <span style="color: #660033;">--line-numbers</span> <span style="color: #000000; font-weight: bold;">|</span> <span style="color: #c20cb9; font-weight: bold;">less</span>
iptables <span style="color: #660033;">-L</span> OUTPUT <span style="color: #660033;">-n</span> <span style="color: #660033;">--line-numbers</span> <span style="color: #000000; font-weight: bold;">|</span> <span style="color: #c20cb9; font-weight: bold;">grep</span> 202.54.1.1</pre></td></tr></table></div><p>Obtendrendremos la lista de IPs. Miramos el número de la izquierda y lo usamos para borrarla. Por ejemplo para borrar la línea 4:</p><div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;">iptables <span style="color: #660033;">-D</span> INPUT <span style="color: #000000;">4</span></pre></td></tr></table></div><p>O para encontrar una ip de origen y borrarla de la regla</p><div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;">iptables <span style="color: #660033;">-D</span> INPUT <span style="color: #660033;">-s</span> 202.54.1.1 <span style="color: #660033;">-j</span> DROP</pre></td></tr></table></div><p>Donde:</p><ul><li><b>-D</b> : Elimina una o más reglas de la cadena seleccionada.</li></ul><h1>#4: Insertar reglas:</h1><p>Para insertar una o más reglas en la cadena seleccionada como el número de cadena dada usamos la siguiente sintaxis. Primero encontramos el número de línea:</p><div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;">iptables <span style="color: #660033;">-L</span> INPUT <span style="color: #660033;">-n</span> <span style="color: #660033;">--line-numbers</span></pre></td></tr></table></div><p>Salida:</p><div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;">Chain INPUT <span style="color: #7a0874; font-weight: bold;">&#40;</span>policy DROP<span style="color: #7a0874; font-weight: bold;">&#41;</span>
num  target     prot opt <span style="color: #7a0874; font-weight: bold;">source</span>               destination
<span style="color: #000000;">1</span>    DROP       all  <span style="color: #660033;">--</span>  202.54.1.1           0.0.0.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">0</span>
<span style="color: #000000;">2</span>    ACCEPT     all  <span style="color: #660033;">--</span>  0.0.0.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">0</span>            0.0.0.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">0</span>           state NEW,ESTABLISHED</pre></td></tr></table></div><p>Para insertar una regla entre 1 y 2;</p><div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;">iptables <span style="color: #660033;">-I</span> INPUT <span style="color: #000000;">2</span> <span style="color: #660033;">-s</span> 202.54.1.2 <span style="color: #660033;">-j</span> DROP</pre></td></tr></table></div><p>Para ver las reglas actualizadas</p><div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;">iptables <span style="color: #660033;">-L</span> INPUT <span style="color: #660033;">-n</span> <span style="color: #660033;">--line-numbers</span></pre></td></tr></table></div><p>Salida:</p><div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;">Chain INPUT <span style="color: #7a0874; font-weight: bold;">&#40;</span>policy DROP<span style="color: #7a0874; font-weight: bold;">&#41;</span>
num  target     prot opt <span style="color: #7a0874; font-weight: bold;">source</span>               destination
<span style="color: #000000;">1</span>    DROP       all  <span style="color: #660033;">--</span>  202.54.1.1           0.0.0.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">0</span>
<span style="color: #000000;">2</span>    DROP       all  <span style="color: #660033;">--</span>  202.54.1.2           0.0.0.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">0</span>
<span style="color: #000000;">3</span>    ACCEPT     all  <span style="color: #660033;">--</span>  0.0.0.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">0</span>            0.0.0.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">0</span>           state NEW,ESTABLISHED</pre></td></tr></table></div><h1>#5: Guardar reglas</h1><p>Para guardar reglas en CentOS / RHEL / Fedora Linux:</p><div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;">service iptables save</pre></td></tr></table></div><p>En este ejemplo, eliminamos una ip y guardamos las reglas del firewall:</p><div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;">iptables <span style="color: #660033;">-A</span> INPUT <span style="color: #660033;">-s</span> 202.5.4.1 <span style="color: #660033;">-j</span> DROP
service iptables save</pre></td></tr></table></div><p>Para todas las demás distros usamos:</p><div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;">iptables-save <span style="color: #000000; font-weight: bold;">&gt;</span> <span style="color: #000000; font-weight: bold;">/</span>root<span style="color: #000000; font-weight: bold;">/</span>my.active.firewall.rules
<span style="color: #c20cb9; font-weight: bold;">cat</span> <span style="color: #000000; font-weight: bold;">/</span>root<span style="color: #000000; font-weight: bold;">/</span>my.active.firewall.rules</pre></td></tr></table></div><h1>#6: Restaurar reglas</h1><p>Para restaurar reglas desde un archivo llamado /root/my.active.firewall.rules:</p><div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;">iptables-restore <span style="color: #000000; font-weight: bold;">&lt;</span> <span style="color: #000000; font-weight: bold;">/</span>root<span style="color: #000000; font-weight: bold;">/</span>my.active.firewall.rules</pre></td></tr></table></div><p>Bajo CentOS / RHEL / Fedora Linux:</p><div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;">service iptables restart</pre></td></tr></table></div><h1>#7: Estableces políticas de firewall por defecto</h1><p>Para borrar todo el tráfico:</p><div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;">iptables <span style="color: #660033;">-P</span> INPUT DROP
iptables <span style="color: #660033;">-P</span> OUTPUT DROP
iptables <span style="color: #660033;">-P</span> FORWARD DROP
iptables <span style="color: #660033;">-L</span> <span style="color: #660033;">-v</span> <span style="color: #660033;">-n</span>
<span style="color: #666666; font-style: italic;">## you will not able to connect anywhere as all traffic is dropped ###</span>
<span style="color: #c20cb9; font-weight: bold;">ping</span> cyberciti.biz
<span style="color: #c20cb9; font-weight: bold;">wget</span> http:<span style="color: #000000; font-weight: bold;">//</span>www.kernel.org<span style="color: #000000; font-weight: bold;">/</span>pub<span style="color: #000000; font-weight: bold;">/</span>linux<span style="color: #000000; font-weight: bold;">/</span>kernel<span style="color: #000000; font-weight: bold;">/</span>v3.0<span style="color: #000000; font-weight: bold;">/</span>testing<span style="color: #000000; font-weight: bold;">/</span>linux-<span style="color: #000000;">3.2</span>-rc5.tar.bz2</pre></td></tr></table></div><h4>#7.1: Solo tráfico entrante bloqueado</h4><p>Para borrar todos los paquetes entrantes / enviados pero permitir el tráfico saliente:</p><div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;">iptables <span style="color: #660033;">-P</span> INPUT DROP
iptables <span style="color: #660033;">-P</span> FORWARD DROP
iptables <span style="color: #660033;">-P</span> OUTPUT ACCEPT
iptables <span style="color: #660033;">-A</span> INPUT <span style="color: #660033;">-m</span> state <span style="color: #660033;">--state</span> NEW,ESTABLISHED <span style="color: #660033;">-j</span> ACCEPT
iptables <span style="color: #660033;">-L</span> <span style="color: #660033;">-v</span> <span style="color: #660033;">-n</span>
<span style="color: #666666; font-style: italic;"># *** now ping and wget should work *** ###</span>
<span style="color: #c20cb9; font-weight: bold;">ping</span> cyberciti.biz
<span style="color: #c20cb9; font-weight: bold;">wget</span> http:<span style="color: #000000; font-weight: bold;">//</span>www.kernel.org<span style="color: #000000; font-weight: bold;">/</span>pub<span style="color: #000000; font-weight: bold;">/</span>linux<span style="color: #000000; font-weight: bold;">/</span>kernel<span style="color: #000000; font-weight: bold;">/</span>v3.0<span style="color: #000000; font-weight: bold;">/</span>testing<span style="color: #000000; font-weight: bold;">/</span>linux-<span style="color: #000000;">3.2</span>-rc5.tar.bz2</pre></td></tr></table></div><h1>#8: Borrar direcciones de red privadas en la interfaz pública</h1><p>IP Spoofing es nada más que para detener los siguientes rangos de direcciones IPv4 para redes privadas en sus interfaces públicas. Los paquetes con direcciones de origen no enrutables deben rechazarse mediante la siguiente sintaxis:</p><div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;">iptables <span style="color: #660033;">-A</span> INPUT <span style="color: #660033;">-i</span> eth1 <span style="color: #660033;">-s</span> 192.168.0.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">24</span> <span style="color: #660033;">-j</span> DROP
iptables <span style="color: #660033;">-A</span> INPUT <span style="color: #660033;">-i</span> eth1 <span style="color: #660033;">-s</span> 10.0.0.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">8</span> <span style="color: #660033;">-j</span> DROP</pre></td></tr></table></div><h1>#9: Bloqueando una direción IP (BLOCK IP)</h1><p>PAra bloquear una ip atacante llamada 1.2.3.4:</p><div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;">iptables <span style="color: #660033;">-A</span> INPUT <span style="color: #660033;">-s</span> 1.2.3.4 <span style="color: #660033;">-j</span> DROP
iptables <span style="color: #660033;">-A</span> INPUT <span style="color: #660033;">-s</span> 192.168.0.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">24</span> <span style="color: #660033;">-j</span> DROP</pre></td></tr></table></div><h1>#10: Bloquear peticiones entrantes de un puerto (BLOCK PORT)</h1><p>Para bloquear todas las solicitudes de servicio en el puerto 80:</p><div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;">iptables <span style="color: #660033;">-A</span> INPUT <span style="color: #660033;">-p</span> tcp <span style="color: #660033;">--dport</span> <span style="color: #000000;">80</span> <span style="color: #660033;">-j</span> DROP
iptables <span style="color: #660033;">-A</span> INPUT <span style="color: #660033;">-i</span> eth1 <span style="color: #660033;">-p</span> tcp <span style="color: #660033;">--dport</span> <span style="color: #000000;">80</span> <span style="color: #660033;">-j</span> DROP</pre></td></tr></table></div><p>Para bloquear el puerto 80 para una ip:</p><div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;">iptables <span style="color: #660033;">-A</span> INPUT <span style="color: #660033;">-p</span> tcp <span style="color: #660033;">-s</span> 1.2.3.4 <span style="color: #660033;">--dport</span> <span style="color: #000000;">80</span> <span style="color: #660033;">-j</span> DROP
iptables <span style="color: #660033;">-A</span> INPUT <span style="color: #660033;">-i</span> eth1 <span style="color: #660033;">-p</span> tcp <span style="color: #660033;">-s</span> 192.168.1.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">24</span> <span style="color: #660033;">--dport</span> <span style="color: #000000;">80</span> <span style="color: #660033;">-j</span> DROP</pre></td></tr></table></div><h1>#11: Bloquear ips de salida</h1><p>Para bloquear el tráfico saliente a un host o dominio en concreto como por ejemplo cyberciti.biz:</p><div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;">host <span style="color: #660033;">-t</span> a cyberciti.biz</pre></td></tr></table></div><p>Salida:</p><div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;">cyberciti.biz has address 75.126.153.206</pre></td></tr></table></div><p>Una vez conocida la dirección ip, bloqueamos todo el tráfico saliente para dicha ip así:</p><div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;">iptables <span style="color: #660033;">-A</span> OUTPUT <span style="color: #660033;">-d</span> 75.126.153.206 <span style="color: #660033;">-j</span> DROP</pre></td></tr></table></div><p>Se puede usar una subred como la siguiente:</p><div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;">iptables <span style="color: #660033;">-A</span> OUTPUT <span style="color: #660033;">-d</span> 192.168.1.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">24</span> <span style="color: #660033;">-j</span> DROP
iptables <span style="color: #660033;">-A</span> OUTPUT <span style="color: #660033;">-o</span> eth1 <span style="color: #660033;">-d</span> 192.168.1.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">24</span> <span style="color: #660033;">-j</span> DROP</pre></td></tr></table></div><h4>#11.1: Ejemplo &#8211; Bloquear el dominio facebook.com</h4><p>Primero, encontrar la dirección ip de facebook.com</p><div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;">host <span style="color: #660033;">-t</span> a www.facebook.com</pre></td></tr></table></div><p>Salida:</p><div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;">www.facebook.com has address 69.171.228.40</pre></td></tr></table></div><p>Buscar el CIDR para 69.171.228.40:</p><div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;"><span style="color: #c20cb9; font-weight: bold;">whois</span> 69.171.228.40 <span style="color: #000000; font-weight: bold;">|</span> <span style="color: #c20cb9; font-weight: bold;">grep</span> CIDR</pre></td></tr></table></div><p>Salida:</p><div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;">CIDR:           69.171.224.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">19</span></pre></td></tr></table></div><p>Para prevenir el acceso externo a facebook.com:</p><div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;">iptables <span style="color: #660033;">-A</span> OUTPUT <span style="color: #660033;">-p</span> tcp <span style="color: #660033;">-d</span> 69.171.224.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">19</span> <span style="color: #660033;">-j</span> DROP</pre></td></tr></table></div><p>Podemos usar también nombres de dominio:</p><div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;">iptables <span style="color: #660033;">-A</span> OUTPUT <span style="color: #660033;">-p</span> tcp <span style="color: #660033;">-d</span> www.facebook.com <span style="color: #660033;">-j</span> DROP
iptables <span style="color: #660033;">-A</span> OUTPUT <span style="color: #660033;">-p</span> tcp <span style="color: #660033;">-d</span> facebook.com <span style="color: #660033;">-j</span> DROP</pre></td></tr></table></div><p>De la página del man de iptables:</p><blockquote><p>&#8230; specifying any name to be resolved with a remote query such as DNS (e.g., facebook.com is a really bad idea), a network IP address (with /mask), or a plain IP address &#8230;</p></blockquote><h1>#12: Log y borrar paquetes</h1><p>Escribe lo siguiente para añadir al log y bloquear IP spoofing en una interfaz pública llamada eth1</p><div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;">iptables <span style="color: #660033;">-A</span> INPUT <span style="color: #660033;">-i</span> eth1 <span style="color: #660033;">-s</span> 10.0.0.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">8</span> <span style="color: #660033;">-j</span> LOG <span style="color: #660033;">--log-prefix</span> <span style="color: #ff0000;">&quot;IP_SPOOF A: &quot;</span>
iptables <span style="color: #660033;">-A</span> INPUT <span style="color: #660033;">-i</span> eth1 <span style="color: #660033;">-s</span> 10.0.0.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">8</span> <span style="color: #660033;">-j</span> DROP</pre></td></tr></table></div><p>Por defecto el log está en el archivo /var/log/messages</p><div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;"><span style="color: #c20cb9; font-weight: bold;">tail</span> <span style="color: #660033;">-f</span> <span style="color: #000000; font-weight: bold;">/</span>var<span style="color: #000000; font-weight: bold;">/</span>log<span style="color: #000000; font-weight: bold;">/</span>messages
<span style="color: #c20cb9; font-weight: bold;">grep</span> <span style="color: #660033;">--color</span> <span style="color: #ff0000;">'IP SPOOF'</span> <span style="color: #000000; font-weight: bold;">/</span>var<span style="color: #000000; font-weight: bold;">/</span>log<span style="color: #000000; font-weight: bold;">/</span>messages</pre></td></tr></table></div><h1>#13: Log y borrar paquetes con un número limitado de entradas al log</h1><p>El módulo -m limit puede limitar el número de entradas al log creadas por tiempo. Se usa para prevenir que el archivo de log se inunde. Para añadir al log y elminar spoofing cada 5 minutos, en ráfagas de 7 entradas:</p><div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;">iptables <span style="color: #660033;">-A</span> INPUT <span style="color: #660033;">-i</span> eth1 <span style="color: #660033;">-s</span> 10.0.0.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">8</span> <span style="color: #660033;">-m</span> limit <span style="color: #660033;">--limit</span> <span style="color: #000000;">5</span><span style="color: #000000; font-weight: bold;">/</span>m <span style="color: #660033;">--limit-burst</span> <span style="color: #000000;">7</span> <span style="color: #660033;">-j</span> LOG <span style="color: #660033;">--log-prefix</span> <span style="color: #ff0000;">&quot;IP_SPOOF A: &quot;</span>
iptables <span style="color: #660033;">-A</span> INPUT <span style="color: #660033;">-i</span> eth1 <span style="color: #660033;">-s</span> 10.0.0.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">8</span> <span style="color: #660033;">-j</span> DROP</pre></td></tr></table></div><h1>#14: Aceptar o denegar tráfico desde dirección MAC</h1><div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;">iptables <span style="color: #660033;">-A</span> INPUT <span style="color: #660033;">-m</span> mac <span style="color: #660033;">--mac-source</span> 00:0F:EA:<span style="color: #000000;">91</span>:04:08 <span style="color: #660033;">-j</span> DROP
<span style="color: #666666; font-style: italic;">## *only accept traffic for TCP port # 8080 from mac 00:0F:EA:91:04:07 * ##</span>
iptables <span style="color: #660033;">-A</span> INPUT <span style="color: #660033;">-p</span> tcp <span style="color: #660033;">--destination-port</span> <span style="color: #000000;">22</span> <span style="color: #660033;">-m</span> mac <span style="color: #660033;">--mac-source</span> 00:0F:EA:<span style="color: #000000;">91</span>:04:07 <span style="color: #660033;">-j</span> ACCEPT</pre></td></tr></table></div><h1>#15: Bloquear o permitir peticiones ping ICMP</h1><p>Para bloquear peticiones ping ICMP</p><div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;">iptables <span style="color: #660033;">-A</span> INPUT <span style="color: #660033;">-p</span> icmp <span style="color: #660033;">--icmp-type</span> echo-request <span style="color: #660033;">-j</span> DROP
iptables <span style="color: #660033;">-A</span> INPUT <span style="color: #660033;">-i</span> eth1 <span style="color: #660033;">-p</span> icmp <span style="color: #660033;">--icmp-type</span> echo-request <span style="color: #660033;">-j</span> DROP</pre></td></tr></table></div><p>Las respuestas al ping también se puede limitar a ciertas redes o hosts.</p><div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;">iptables <span style="color: #660033;">-A</span> INPUT <span style="color: #660033;">-s</span> 192.168.1.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">24</span> <span style="color: #660033;">-p</span> icmp <span style="color: #660033;">--icmp-type</span> echo-request <span style="color: #660033;">-j</span> ACCEPT</pre></td></tr></table></div><p>Lo siguiente solo acepta limitados tipos de peticiones ICMP:</p><div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;"><span style="color: #666666; font-style: italic;">### ** assumed that default INPUT policy set to DROP ** #############</span>
iptables <span style="color: #660033;">-A</span> INPUT <span style="color: #660033;">-p</span> icmp <span style="color: #660033;">--icmp-type</span> echo-reply <span style="color: #660033;">-j</span> ACCEPT
iptables <span style="color: #660033;">-A</span> INPUT <span style="color: #660033;">-p</span> icmp <span style="color: #660033;">--icmp-type</span> destination-unreachable <span style="color: #660033;">-j</span> ACCEPT
iptables <span style="color: #660033;">-A</span> INPUT <span style="color: #660033;">-p</span> icmp <span style="color: #660033;">--icmp-type</span> time-exceeded <span style="color: #660033;">-j</span> ACCEPT
<span style="color: #666666; font-style: italic;">## ** all our server to respond to pings ** ##</span>
iptables <span style="color: #660033;">-A</span> INPUT <span style="color: #660033;">-p</span> icmp <span style="color: #660033;">--icmp-type</span> echo-request <span style="color: #660033;">-j</span> ACCEPT</pre></td></tr></table></div><h1>#16: Abrir un rango de puertos</h1><div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;">iptables <span style="color: #660033;">-A</span> INPUT <span style="color: #660033;">-m</span> state <span style="color: #660033;">--state</span> NEW <span style="color: #660033;">-m</span> tcp <span style="color: #660033;">-p</span> tcp <span style="color: #660033;">--dport</span> <span style="color: #000000;">7000</span>:<span style="color: #000000;">7010</span> <span style="color: #660033;">-j</span> ACCEPT</pre></td></tr></table></div><h1>#17: Abrir un rango de direcciones ip</h1><div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;"><span style="color: #666666; font-style: italic;">## only accept connection to tcp port 80 (Apache) if ip is between 192.168.1.100 and 192.168.1.200 ##</span>
iptables <span style="color: #660033;">-A</span> INPUT <span style="color: #660033;">-p</span> tcp <span style="color: #660033;">--destination-port</span> <span style="color: #000000;">80</span> <span style="color: #660033;">-m</span> iprange <span style="color: #660033;">--src-range</span> 192.168.1.100-192.168.1.200 <span style="color: #660033;">-j</span> ACCEPT</pre></td></tr></table></div><div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;"><span style="color: #666666; font-style: italic;">## nat example ##</span>
iptables <span style="color: #660033;">-t</span> nat <span style="color: #660033;">-A</span> POSTROUTING <span style="color: #660033;">-j</span> SNAT <span style="color: #660033;">--to-source</span> 192.168.1.20-192.168.1.25</pre></td></tr></table></div><h1>#19: Bloquear o abrir puertos comunes</h1><div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;">Replace ACCEPT with DROP to block port:
<span style="color: #666666; font-style: italic;">## open port ssh tcp port 22 ##</span>
iptables <span style="color: #660033;">-A</span> INPUT <span style="color: #660033;">-m</span> state <span style="color: #660033;">--state</span> NEW <span style="color: #660033;">-m</span> tcp <span style="color: #660033;">-p</span> tcp <span style="color: #660033;">--dport</span> <span style="color: #000000;">22</span> <span style="color: #660033;">-j</span> ACCEPT
iptables <span style="color: #660033;">-A</span> INPUT <span style="color: #660033;">-s</span> 192.168.1.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">24</span> <span style="color: #660033;">-m</span> state <span style="color: #660033;">--state</span> NEW <span style="color: #660033;">-p</span> tcp <span style="color: #660033;">--dport</span> <span style="color: #000000;">22</span> <span style="color: #660033;">-j</span> ACCEPT
&nbsp;
<span style="color: #666666; font-style: italic;">## open cups (printing service) udp/tcp port 631 for LAN users ##</span>
iptables <span style="color: #660033;">-A</span> INPUT <span style="color: #660033;">-s</span> 192.168.1.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">24</span> <span style="color: #660033;">-p</span> udp <span style="color: #660033;">-m</span> udp <span style="color: #660033;">--dport</span> <span style="color: #000000;">631</span> <span style="color: #660033;">-j</span> ACCEPT
iptables <span style="color: #660033;">-A</span> INPUT <span style="color: #660033;">-s</span> 192.168.1.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">24</span> <span style="color: #660033;">-p</span> tcp <span style="color: #660033;">-m</span> tcp <span style="color: #660033;">--dport</span> <span style="color: #000000;">631</span> <span style="color: #660033;">-j</span> ACCEPT
&nbsp;
<span style="color: #666666; font-style: italic;">## allow time sync via NTP for lan users (open udp port 123) ##</span>
iptables <span style="color: #660033;">-A</span> INPUT <span style="color: #660033;">-s</span> 192.168.1.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">24</span> <span style="color: #660033;">-m</span> state <span style="color: #660033;">--state</span> NEW <span style="color: #660033;">-p</span> udp <span style="color: #660033;">--dport</span> <span style="color: #000000;">123</span> <span style="color: #660033;">-j</span> ACCEPT
&nbsp;
<span style="color: #666666; font-style: italic;">## open tcp port 25 (smtp) for all ##</span>
iptables <span style="color: #660033;">-A</span> INPUT <span style="color: #660033;">-m</span> state <span style="color: #660033;">--state</span> NEW <span style="color: #660033;">-p</span> tcp <span style="color: #660033;">--dport</span> <span style="color: #000000;">25</span> <span style="color: #660033;">-j</span> ACCEPT
&nbsp;
<span style="color: #666666; font-style: italic;"># open dns server ports for all ##</span>
iptables <span style="color: #660033;">-A</span> INPUT <span style="color: #660033;">-m</span> state <span style="color: #660033;">--state</span> NEW <span style="color: #660033;">-p</span> udp <span style="color: #660033;">--dport</span> <span style="color: #000000;">53</span> <span style="color: #660033;">-j</span> ACCEPT
iptables <span style="color: #660033;">-A</span> INPUT <span style="color: #660033;">-m</span> state <span style="color: #660033;">--state</span> NEW <span style="color: #660033;">-p</span> tcp <span style="color: #660033;">--dport</span> <span style="color: #000000;">53</span> <span style="color: #660033;">-j</span> ACCEPT
&nbsp;
<span style="color: #666666; font-style: italic;">## open http/https (Apache) server port to all ##</span>
iptables <span style="color: #660033;">-A</span> INPUT <span style="color: #660033;">-m</span> state <span style="color: #660033;">--state</span> NEW <span style="color: #660033;">-p</span> tcp <span style="color: #660033;">--dport</span> <span style="color: #000000;">80</span> <span style="color: #660033;">-j</span> ACCEPT
iptables <span style="color: #660033;">-A</span> INPUT <span style="color: #660033;">-m</span> state <span style="color: #660033;">--state</span> NEW <span style="color: #660033;">-p</span> tcp <span style="color: #660033;">--dport</span> <span style="color: #000000;">443</span> <span style="color: #660033;">-j</span> ACCEPT
&nbsp;
<span style="color: #666666; font-style: italic;">## open tcp port 110 (pop3) for all ##</span>
iptables <span style="color: #660033;">-A</span> INPUT <span style="color: #660033;">-m</span> state <span style="color: #660033;">--state</span> NEW <span style="color: #660033;">-p</span> tcp <span style="color: #660033;">--dport</span> <span style="color: #000000;">110</span> <span style="color: #660033;">-j</span> ACCEPT
&nbsp;
<span style="color: #666666; font-style: italic;">## open tcp port 143 (imap) for all ##</span>
iptables <span style="color: #660033;">-A</span> INPUT <span style="color: #660033;">-m</span> state <span style="color: #660033;">--state</span> NEW <span style="color: #660033;">-p</span> tcp <span style="color: #660033;">--dport</span> <span style="color: #000000;">143</span> <span style="color: #660033;">-j</span> ACCEPT
&nbsp;
<span style="color: #666666; font-style: italic;">## open access to Samba file server for lan users only ##</span>
iptables <span style="color: #660033;">-A</span> INPUT <span style="color: #660033;">-s</span> 192.168.1.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">24</span> <span style="color: #660033;">-m</span> state <span style="color: #660033;">--state</span> NEW <span style="color: #660033;">-p</span> tcp <span style="color: #660033;">--dport</span> <span style="color: #000000;">137</span> <span style="color: #660033;">-j</span> ACCEPT
iptables <span style="color: #660033;">-A</span> INPUT <span style="color: #660033;">-s</span> 192.168.1.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">24</span> <span style="color: #660033;">-m</span> state <span style="color: #660033;">--state</span> NEW <span style="color: #660033;">-p</span> tcp <span style="color: #660033;">--dport</span> <span style="color: #000000;">138</span> <span style="color: #660033;">-j</span> ACCEPT
iptables <span style="color: #660033;">-A</span> INPUT <span style="color: #660033;">-s</span> 192.168.1.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">24</span> <span style="color: #660033;">-m</span> state <span style="color: #660033;">--state</span> NEW <span style="color: #660033;">-p</span> tcp <span style="color: #660033;">--dport</span> <span style="color: #000000;">139</span> <span style="color: #660033;">-j</span> ACCEPT
iptables <span style="color: #660033;">-A</span> INPUT <span style="color: #660033;">-s</span> 192.168.1.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">24</span> <span style="color: #660033;">-m</span> state <span style="color: #660033;">--state</span> NEW <span style="color: #660033;">-p</span> tcp <span style="color: #660033;">--dport</span> <span style="color: #000000;">445</span> <span style="color: #660033;">-j</span> ACCEPT
&nbsp;
<span style="color: #666666; font-style: italic;">## open access to proxy server for lan users only ##</span>
iptables <span style="color: #660033;">-A</span> INPUT <span style="color: #660033;">-s</span> 192.168.1.0<span style="color: #000000; font-weight: bold;">/</span><span style="color: #000000;">24</span> <span style="color: #660033;">-m</span> state <span style="color: #660033;">--state</span> NEW <span style="color: #660033;">-p</span> tcp <span style="color: #660033;">--dport</span> <span style="color: #000000;">3128</span> <span style="color: #660033;">-j</span> ACCEPT
&nbsp;
<span style="color: #666666; font-style: italic;">## open access to mysql server for lan users only ##</span>
iptables <span style="color: #660033;">-I</span> INPUT <span style="color: #660033;">-p</span> tcp <span style="color: #660033;">--dport</span> <span style="color: #000000;">3306</span> <span style="color: #660033;">-j</span> ACCEPT</pre></td></tr></table></div><h1>#20: Restringir el número de conexiones paralelas a un servidor por direccion Ip del cliente.</h1><p>Se puede usar connlimit para crear algunas restricciones. Para permitir 3 conexiones ssh por cliente:</p><div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;">iptables <span style="color: #660033;">-A</span> INPUT <span style="color: #660033;">-p</span> tcp <span style="color: #660033;">--syn</span> <span style="color: #660033;">--dport</span> <span style="color: #000000;">22</span> <span style="color: #660033;">-m</span> connlimit <span style="color: #660033;">--connlimit-above</span> <span style="color: #000000;">3</span> <span style="color: #660033;">-j</span> REJECT</pre></td></tr></table></div><p>Establecer las peticiones HTTP a 20:</p><div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;">iptables <span style="color: #660033;">-p</span> tcp <span style="color: #660033;">--syn</span> <span style="color: #660033;">--dport</span> <span style="color: #000000;">80</span> <span style="color: #660033;">-m</span> connlimit <span style="color: #660033;">--connlimit-above</span> <span style="color: #000000;">20</span> <span style="color: #660033;">--connlimit-mask</span> <span style="color: #000000;">24</span> <span style="color: #660033;">-j</span> DROP</pre></td></tr></table></div><p>donde:</p><ul><li><b>&#8211;connlimit-above 3</b> : Coincide si el número de conexiones existentes está por encima de 3.</li><li><b>&#8211;connlimit-mask 24</b> : Grupos de hosts usando el prefijo de longitud. Para IPv4, debe ser un número entre 0 y 32 (incluyéndolos.)</li></ul><h1>#21: HowTO: Use iptables Like a Pro</h1><p>Para más información sobre iptables, échale un vistazo al manual:</p><div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;"><span style="color: #c20cb9; font-weight: bold;">man</span> iptables</pre></td></tr></table></div><p>Para ver la ayuda en general o de un comando específico:</p><div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;">iptables <span style="color: #660033;">-h</span>
iptables <span style="color: #660033;">-j</span> DROP <span style="color: #660033;">-h</span></pre></td></tr></table></div><h4>#21.1: Probando nuestro firewall</h4><p>Conocer si hay puertos abiertos o no:</p><div class="wp_syntax"><table><tr><td class="code"><pre class="bash" style="font-family:monospace;"><span style="color: #c20cb9; font-weight: bold;">netstat</span> <span style="color: #660033;">-tulpn</span></pre></td></tr></table></div><p>Es recomendable instalarse un <a href="http://www.elbauldelprogramador.com/2011/05/esnifando-la-red-pruebas-de-seguridad.html" >sniffer</a> como tcpdupm y ngrep para probar la configuración de nuestro firewall.</p><blockquote><h2>Conclusión</h2><p>Esta entrada solo lista las reglas básicas para los usuarios nuevos en linux. Se pueden crear reglas más complejas. Requiere una buena comprensión de TCP/IP, tunning del kernel linux via sysctl.conf y un buen conocimiento de nuestra configuración.</p></blockquote><p class="alert">Fuente original: <a target="_blank" href="http://www.cyberciti.biz/tips/linux-iptables-examples.html" onclick="javascript:_gaq.push(['_trackEvent','outbound-article','http://www.cyberciti.biz/tips/linux-iptables-examples.html']);">cyberciti</a></p><div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-official sd-sharing"><h3 class="sd-title">Compártelo:</h3><div class="sd-content"><ul><li class="share-twitter"><div class="twitter_button"><iframe allowtransparency="true" frameborder="0" scrolling="no" src="http://platform.twitter.com/widgets/tweet_button.html?url=http%3A%2F%2Fwww.elbauldelprogramador.com%2Fnoticias%2Flinux%2F20-ejemplos-de-iptables-para-sysadmins%2F&#038;counturl=http%3A%2F%2Fwww.elbauldelprogramador.com%2Fnoticias%2Flinux%2F20-ejemplos-de-iptables-para-sysadmins%2F&#038;count=horizontal&#038;text=20%20ejemplos%20de%20iptables%20para%20SysAdmins%20novatos%3A" style="width:101px; height:20px;"></iframe></div></li><li class="share-facebook"><div class="like_button"><iframe src="http://www.facebook.com/plugins/like.php?href=http%3A%2F%2Fwww.elbauldelprogramador.com%2Fnoticias%2Flinux%2F20-ejemplos-de-iptables-para-sysadmins%2F&amp;layout=button_count&amp;show_faces=false&amp;action=like&amp;colorscheme=light&amp;height=21&amp;locale=es_ES&amp;width=122" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:128px; height:21px;" allowTransparency="true"></iframe></div></li><li class="share-google-plus-1"><div class="googleplus1_button"><div class="g-plusone" data-size="medium" data-callback="sharing_plusone" data-href="http://www.elbauldelprogramador.com/noticias/linux/20-ejemplos-de-iptables-para-sysadmins/"></div></div></li><li class="share-linkedin"><div class="linkedin_button"><script type="in/share" data-url="http://www.elbauldelprogramador.com/noticias/linux/20-ejemplos-de-iptables-para-sysadmins/" data-counter="right"></script></div></li><li class="share-end"></li></ul><div class="sharing-clear"></div></div></div></div></div><footer class="entry-footer"> <span class="cat-links">Posted in <a href="http://www.elbauldelprogramador.com/opensource/aplicaciones/" title="Ver todas las entradas en aplicaciones" rel="category tag">aplicaciones</a>, <a href="http://www.elbauldelprogramador.com/internet/" title="Ver todas las entradas en internet" rel="category tag">internet</a>, <a href="http://www.elbauldelprogramador.com/noticias/linux/" title="Ver todas las entradas en linux" rel="category tag">linux</a>, <a href="http://www.elbauldelprogramador.com/opensource/seguridad/" title="Ver todas las entradas en seguridad" rel="category tag">seguridad</a>.</span> </footer> </article> <aside id="author-info" class="row"><h2 class="span8">About Alejandro Alcalde</h2><div id="author-avatar" class="span1"> <img alt='' src='http://0.gravatar.com/avatar/08895492876c3a8160011ac0ef0c3d1c?s=70&amp;d=identicon&amp;r=G' class='avatar avatar-70 photo' height='70' width='70' /></div><div id="author-description" class="span7"> Técnico Superior en Desarrollo de aplicaciones informáticas y actualmente estudiante de Grado en Ingeniería informática en Granada<a href="http://www.twitter.com/elbaulp">Twitter </a> | <a href="http://www.facebook.com/elbauldelprogramador">Facebook </a> | <a href="http://www.linkedin.com/in/algui91">LinkedIn </a> | <a href="https://plus.google.com/117030001562039350135">G+ </a> | <a href="http://www.youtube.com/user/algui91">Youtube</a><div id="author-link"> <a href="http://www.elbauldelprogramador.com/author/algui91/" rel="author"> View all posts by Alejandro Alcalde <span class="meta-nav">&rarr;</span> </a></div></div> </aside><div id="comments"><h2 id="comments-title"> 2 thoughts on &ldquo;<span>20 ejemplos de iptables para SysAdmins novatos</span>&rdquo;</h2><ol class="commentlist unstyled"><li id="li-comment-456" class="comment byuser comment-author-juanchiy2k even thread-even depth-1"> <article id="comment-456" class="comment row"><div class="comment-author-avatar span1"> <img alt='' src='http://0.gravatar.com/avatar/66435fd40825154e63251dfb01ffb25e?s=70&amp;d=identicon&amp;r=G' class='avatar avatar-70 photo' height='70' width='70' /></div> <footer class="comment-meta span7"><p class="comment-author vcard"> <span class="fn">juanchiy2k</span> <span class="says">said</span> on <a href="http://www.elbauldelprogramador.com/noticias/linux/20-ejemplos-de-iptables-para-sysadmins/#comment-456"><time pubdate datetime="2012-07-13T14:44:01+00:00">13 julio, 2012 at 14:44</time></a>:</p> </footer><div class="comment-content span7"><p>Hola Alejandro.<br /> Excelente tutorial. Mi deseo es bloquear las redes sociales en mi trabajo, lo hice con squid en modo transparente pero las saltean al entrar por https. Hice las pruebas en una virtual pc y me funcionó bien. El asunto es que no me esta funcionando en el servidor de producción. Este tiene dos placas de red, eth0 por donde entra el tráfico de internet y eth1 para conectarse a la red. Para el caso de Facebook hago lo siguiente:</p><p>#Bloqueamos Facebook<br /> iptables -A OUTPUT -p tcp -d 69.63.176.0/20 &#8211;dport 443 -j DROP<br /> iptables -A OUTPUT -p tcp -d 66.220.144.0/20 &#8211;dport 443 -j DROP<br /> iptables -A OUTPUT -p tcp -d 69.171.224.0/19 &#8211;dport 443 -j DROP<br /> iptables -A OUTPUT -p tcp -d <a href="http://www.facebook.com" onclick="javascript:_gaq.push(['_trackEvent','outbound-comment','http://www.facebook.com']);" rel="nofollow">http://www.facebook.com</a> &#8211;dport 443 -j DROP<br /> iptables -A OUTPUT -p tcp -d facebook.com &#8211;dport 443 -j DROP</p><p>¿Alguna sugerencia?.</p><p>Saludos.</p> <a class='comment-reply-link' href='/noticias/linux/20-ejemplos-de-iptables-para-sysadmins/?replytocom=456#respond' onclick='return addComment.moveForm("comment-456", "456", "respond", "314")'>Reply <span>&darr;</span></a></div> </article><ul class='children'><li id="li-comment-457" class="comment byuser comment-author-algui91 bypostauthor odd alt depth-2"> <article id="comment-457" class="comment row"><div class="comment-author-avatar span1 offset1"> <img alt='' src='http://0.gravatar.com/avatar/08895492876c3a8160011ac0ef0c3d1c?s=70&amp;d=identicon&amp;r=G' class='avatar avatar-70 photo' height='70' width='70' /></div> <footer class="comment-meta span6"><p class="comment-author vcard"> <span class="fn"><a href="http://www.elbauldelprogramador.com"   rel='external nofollow' class='url'>Alejandro Alcalde</a></span> <span class="says">said</span> on <a href="http://www.elbauldelprogramador.com/noticias/linux/20-ejemplos-de-iptables-para-sysadmins/#comment-457"><time pubdate datetime="2012-07-14T14:14:35+00:00">14 julio, 2012 at 14:14</time></a>:</p> </footer><div class="comment-content span6"><p>Hola Juanchiy2k, esta entrada la traduje de <a href="http://www.cyberciti.biz/tips/linux-iptables-examples.html" onclick="javascript:_gaq.push(['_trackEvent','outbound-comment','http://www.cyberciti.biz/tips/linux-iptables-examples.html']);" rel="nofollow">http://www.cyberciti.biz/tips/linux-iptables-examples.html</a>, como cito al final de la entrada, no tengo gran conocimiento de iptables, aunque mi intención es aprender en breve. Si quiere puede pasarse por la entrada original y preguntar allí. Un saludo y disculpa.</p> <a class='comment-reply-link' href='/noticias/linux/20-ejemplos-de-iptables-para-sysadmins/?replytocom=457#respond' onclick='return addComment.moveForm("comment-457", "457", "respond", "314")'>Reply <span>&darr;</span></a></div> </article></li></ul></li></ol></div><div id="respond"><h3 id="reply-title"><legend>Leave a reply</legend> <small><a rel="nofollow" id="cancel-comment-reply-link" href="/noticias/linux/20-ejemplos-de-iptables-para-sysadmins/#respond" style="display:none;">Cancelar respuesta</a></small></h3><form action="http://www.elbauldelprogramador.com/wp-comments-post.php" method="post" id="commentform"><div class="form-horizontal"><div class="comment-form-author control-group"> <label for="author" class="control-label">Name</label><div class="controls"> <input id="author" name="author" type="text" value="" size="30" aria-required='true' /><p class="help-inline"><span class="required">required</span></p></div></div><div class="comment-form-email control-group"> <label for="email" class="control-label">Email</label><div class="controls"> <input id="email" name="email" type="email" value="" size="30" aria-required='true' /><p class="help-inline"><span class="required">required</span>, will not be published</p></div></div><div class="comment-form-url control-group"> <label for="url" class="control-label">Website</label><div class="controls"> <input id="url" name="url" type="url" value="" size="30" /></div></div><div class="comment-form-comment control-group"><label class="control-label" for="comment">Comment</label><div class="controls"><textarea class="span7" id="comment" name="comment" rows="8" aria-required="true"></textarea></div></div><div class="form-allowed-tags control-group"><label class="control-label">You may use these <abbr title="HyperText Markup Language">HTML</abbr> tags and attributes: </label><div class="controls"><pre>&lt;a href=&quot;&quot; title=&quot;&quot;&gt; &lt;abbr title=&quot;&quot;&gt; &lt;acronym title=&quot;&quot;&gt; &lt;b&gt; &lt;blockquote cite=&quot;&quot;&gt; &lt;cite&gt; &lt;code&gt; &lt;del datetime=&quot;&quot;&gt; &lt;em&gt; &lt;i&gt; &lt;q cite=&quot;&quot;&gt; &lt;strike&gt; &lt;strong&gt; </pre></div></div><div class="form-actions"><p class="form-submit"> <input name="submit" type="submit" id="submit" value="Publicar comentario" /> <input type='hidden' name='comment_post_ID' value='314' id='comment_post_ID' /> <input type='hidden' name='comment_parent' id='comment_parent' value='0' /></p><p class="comment-subscription-form"><input type="checkbox" name="subscribe_comments" id="subscribe_comments" value="subscribe" style="width: auto; -moz-appearance: checkbox; -webkit-appearance: checkbox;" /> <label class="subscribe-label" id="subscribe-label" for="subscribe_comments">Recibir un email con los siguientes comentarios a esta entrada.</label></p><p class="comment-subscription-form"><input type="checkbox" name="subscribe_blog" id="subscribe_blog" value="subscribe" style="width: auto; -moz-appearance: checkbox; -webkit-appearance: checkbox;" /> <label class="subscribe-label" id="subscribe-blog-label" for="subscribe_blog">Recibir un email con cada nuevo post.</label></p></div></div></form></div><script type="text/javascript">jQuery(document).ready(function(){jQuery('#commentform').submit(function(){_gaq.push(['_setAccount','UA-19017085-2'],['_trackEvent','comment','submit']);});});</script><nav id="nav-single" class="pager"><h3 class="assistive-text">Post navigation</h3> <span class="next"><a href="http://www.elbauldelprogramador.com/noticias/cursos/nueva-guia-think-different-how-to-build/" rel="next">Next Post <span class="meta-nav">&rarr;</span></a></span> <span class="previous"><a href="http://www.elbauldelprogramador.com/programacion/programacion-android-insertando/" rel="prev"><span class="meta-nav">&larr;</span> Previous Post</a></span> </nav></div> </section><section id="secondary" class="widget-area span4" role="complementary"> <aside id="text-7" class="widget well widget_text"><h2 class="widget-title">¿Me votas?</h2><div class="textwidget"><a href="http://bitacoras.com/premios12/votar/d3d5c583739cd5be173a072d4d964d9f703d7d23" onclick="javascript:_gaq.push(['_trackEvent','outbound-widget','http://bitacoras.com/premios12/votar/d3d5c583739cd5be173a072d4d964d9f703d7d23']);"><img src="http://static2.bitacoras.com/images/premios/2012/botones/180x120.gif" border="0" alt="Votar en los Premios Bitacoras.com" /></a></div> </aside><aside id="text-5" class="widget well widget_text"><div class="textwidget"><div style="text-align:center"><script type="text/javascript"><!--
google_ad_client = "ca-pub-9043332344373532";
/* Sidebar grande */
google_ad_slot = "9665585866";
google_ad_width = 250;
google_ad_height = 250;
//--></script><script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js"></script></div></div> </aside><aside id="php_widget-4" class="widget well php_widget"><h2 class="widget-title">Sígueme</h2><div style="float: left; margin-right: 10px; margin-top: 15px;" > <a href="http://feeds.feedburner.com/elBauldelProgramador" onclick="javascript:_gaq.push(['_trackEvent','outbound-widget','http://feeds.feedburner.com/elBauldelProgramador']);" title="Suscríbete a Entradas"><img src="http://www.elbauldelprogramador.com/wp-content/plugins/jetpack/_inc/images/rss/orange-medium.png" alt="RSS Feed"></a></div><div class="g-plus" data-width="255" data-height="69" data-href="//plus.google.com/108003822606696308728?rel=publisher"></div><script type="text/javascript">window.___gcfg={lang:'es'};(function(){var po=document.createElement('script');po.type='text/javascript';po.async=true;po.src='https://apis.google.com/js/plusone.js';var s=document.getElementsByTagName('script')[0];s.parentNode.insertBefore(po,s);})();</script><div style="float:left"><span class="twittercount"><a href="http://www.twitter.com/elbaulp"><img style="float:left" src="/wp-content/themes/the-bootstrap-child/images/twitter48.png" /> 903 Seguidores, únete!</a></spam></div><div style="float:right"> <iframe src="http://www.facebook.com/plugins/likebox.php?href=https%3A%2F%2Fwww.facebook.com%2Felbauldelprogramador&amp;width=180&amp;height=110&amp;colorscheme=light&amp;show_faces=false&amp;stream=false&amp;header=false&amp;force_wall=false&amp;locale=es_ES" scrolling="no" frameborder="0" style="border: none; overflow: hidden; width: 180px;  height: 110px; background: #fff"></iframe></div><center><form action="https://www.paypal.com/cgi-bin/webscr" method="post"> <input type="hidden" name="cmd" value="_s-xclick" /> <input type="hidden" name="hosted_button_id" value="3BT3MZW948G74" /> <input type="image" src="http://www.elbauldelprogramador.com/wp-content/uploads/2012/04/Donar.png" style="border:none;" name="submit" alt="PayPal. La forma rápida y segura de pagar en Internet." /></form></center></aside><aside id="blog_subscription-2" class="widget well jetpack_subscription_widget"><h2 class="widget-title"><label for="subscribe-field">Suscripción por correo</label></h2> <a name="subscribe-blog"></a><form action="" method="post" accept-charset="utf-8" id="subscribe-blog"><p>Recíbe las entradas vía email</p><p>Únete a otros 30 suscriptores</p><p><input type="text" name="email" style="width: 95%; padding: 1px 2px" value="Correo electrónico" id="subscribe-field" onclick="if ( this.value == 'Correo electrónico' ) { this.value = ''; }" onblur="if ( this.value == '' ) { this.value = 'Correo electrónico'; }" /></p><p> <input type="hidden" name="action" value="subscribe" /> <input type="hidden" name="source" value="http://www.elbauldelprogramador.com/noticias/linux/20-ejemplos-de-iptables-para-sysadmins/" /> <input type="hidden" name="sub-type" value="widget" /> <input type="hidden" name="redirect_fragment" value="blog_subscription-2" /> <input type="submit" value="Suscribir" name="jetpack_subscriptions_widget" /></p></form> </aside><aside id="categories-2" class="widget well widget_categories"><h2 class="widget-title">Categorías</h2><select name='cat' id='cat' class='postform' ><option value='-1'>Elegir categoría</option><option class="level-0" value="103">Artículos&nbsp;&nbsp;(14)</option><option class="level-0" value="140">Hacking&nbsp;&nbsp;(2)</option><option class="level-0" value="180">How To&nbsp;&nbsp;(19)</option><option class="level-0" value="17">internet&nbsp;&nbsp;(64)</option><option class="level-0" value="4">noticias&nbsp;&nbsp;(172)</option><option class="level-1" value="15">&nbsp;&nbsp;&nbsp;cursos&nbsp;&nbsp;(46)</option><option class="level-1" value="27">&nbsp;&nbsp;&nbsp;hackathon&nbsp;&nbsp;(4)</option><option class="level-1" value="46">&nbsp;&nbsp;&nbsp;Informática&nbsp;&nbsp;(1)</option><option class="level-1" value="3">&nbsp;&nbsp;&nbsp;linux&nbsp;&nbsp;(49)</option><option class="level-1" value="47">&nbsp;&nbsp;&nbsp;Tecnología&nbsp;&nbsp;(6)</option><option class="level-0" value="25">offtopic&nbsp;&nbsp;(67)</option><option class="level-1" value="12">&nbsp;&nbsp;&nbsp;curiosidades&nbsp;&nbsp;(42)</option><option class="level-1" value="28">&nbsp;&nbsp;&nbsp;Enlaces de la semana&nbsp;&nbsp;(3)</option><option class="level-1" value="10">&nbsp;&nbsp;&nbsp;Humor&nbsp;&nbsp;(8)</option><option class="level-1" value="13">&nbsp;&nbsp;&nbsp;juegos&nbsp;&nbsp;(11)</option><option class="level-1" value="19">&nbsp;&nbsp;&nbsp;meme&nbsp;&nbsp;(2)</option><option class="level-1" value="24">&nbsp;&nbsp;&nbsp;vídeo de la semana&nbsp;&nbsp;(7)</option><option class="level-0" value="8">opensource&nbsp;&nbsp;(140)</option><option class="level-1" value="18">&nbsp;&nbsp;&nbsp;aplicaciones&nbsp;&nbsp;(44)</option><option class="level-1" value="23">&nbsp;&nbsp;&nbsp;seguridad&nbsp;&nbsp;(13)</option><option class="level-0" value="6">programacion&nbsp;&nbsp;(217)</option><option class="level-1" value="131">&nbsp;&nbsp;&nbsp;Algoritmos&nbsp;&nbsp;(2)</option><option class="level-1" value="22">&nbsp;&nbsp;&nbsp;android&nbsp;&nbsp;(82)</option><option class="level-1" value="11">&nbsp;&nbsp;&nbsp;BaseDeDatos&nbsp;&nbsp;(37)</option><option class="level-1" value="26">&nbsp;&nbsp;&nbsp;bash&nbsp;&nbsp;(8)</option><option class="level-1" value="139">&nbsp;&nbsp;&nbsp;C&nbsp;&nbsp;(1)</option><option class="level-1" value="7">&nbsp;&nbsp;&nbsp;c++&nbsp;&nbsp;(19)</option><option class="level-1" value="132">&nbsp;&nbsp;&nbsp;Inteligencia Artificial&nbsp;&nbsp;(1)</option><option class="level-1" value="73">&nbsp;&nbsp;&nbsp;php&nbsp;&nbsp;(3)</option><option class="level-1" value="16">&nbsp;&nbsp;&nbsp;plsql&nbsp;&nbsp;(14)</option><option class="level-1" value="5">&nbsp;&nbsp;&nbsp;python&nbsp;&nbsp;(11)</option><option class="level-1" value="9">&nbsp;&nbsp;&nbsp;script&nbsp;&nbsp;(16)</option><option class="level-1" value="14">&nbsp;&nbsp;&nbsp;SDL&nbsp;&nbsp;(8)</option><option class="level-0" value="1">Sin categoría&nbsp;&nbsp;(16)</option><option class="level-0" value="20">SO&nbsp;&nbsp;(12)</option><option class="level-1" value="21">&nbsp;&nbsp;&nbsp;procesos&nbsp;&nbsp;(2)</option> </select><script type='text/javascript'>var dropdown=document.getElementById("cat");function onCatChange(){if(dropdown.options[dropdown.selectedIndex].value>0){location.href="http://www.elbauldelprogramador.com/?cat="+dropdown.options[dropdown.selectedIndex].value;}}
dropdown.onchange=onCatChange;</script></aside><aside id="linkcat-2" class="widget well widget_links"><h2 class="widget-title">Sitios de interés</h2><ul class='xoxo blogroll'><li><a href="http://www.webayunate.com" rel="acquaintance colleague" title="Actualidad, informática, gadgets, curiosidades, videojuegos, mundo laboral, productividad, tutoriales y más!" target="_blank" onclick="javascript:_gaq.push(['_trackEvent','outbound-blogroll','http://www.webayunate.com']);"><img src="http://www.webayunate.com/wp-content/themes/WebAyunate/images/webayunate.png"  alt="Webayunate"  title="Actualidad, informática, gadgets, curiosidades, videojuegos, mundo laboral, productividad, tutoriales y más!" /> Webayunate</a></li></ul> </aside> <aside id="meta-2" class="widget well widget_meta"><h2 class="widget-title">Meta</h2><ul><li><a rel="nofollow" href="http://www.elbauldelprogramador.com/wp-login.php?action=register">Registrarse</a></li><li><a rel="nofollow" href="http://www.elbauldelprogramador.com/wp-login.php">Acceder</a></li><li><a href="http://www.elbauldelprogramador.com/feed/" title="Suscribirse a este sitio usando RSS 2.0"><abbr title="Really Simple Syndication">RSS</abbr> de las entradas</a></li><li><a href="http://www.elbauldelprogramador.com/comments/feed/" title="Últimos comentarios a todas las entradas en RSS"><abbr title="Really Simple Syndication">RSS</abbr> de los comentarios</a></li><li><a href="http://es.wordpress.org/" title="Gestionado con WordPress, una avanzada plataforma semántica de publicación personal.">WordPress.org</a></li></ul> </aside><aside id="text-2" class="widget well widget_text"><h2 class="widget-title">Usuarios en linea</h2><div class="textwidget"><a target="_blank" href="http://whos.amung.us/stats/6tp9kpzf0d4z/" onclick="javascript:_gaq.push(['_trackEvent','outbound-widget','http://whos.amung.us/stats/6tp9kpzf0d4z/']);"><img src="http://whos.amung.us/widget/6tp9kpzf0d4z.png" alt="web stats" width="81" height="29" border="0" /></a></div> </aside><aside id="text-6" class="widget well widget_text"><h2 class="widget-title">Licencia del Blog</h2><div class="textwidget"><span style="font-size:12px"><a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.es_ES" onclick="javascript:_gaq.push(['_trackEvent','outbound-widget','http://creativecommons.org/licenses/by-nc-sa/3.0/deed.es_ES']);"><img alt="Licencia de Creative Commons" style="border-width:0" src="http://i.creativecommons.org/l/by-nc-sa/3.0/88x31.png" /></a><br /><span xmlns:dct="http://purl.org/dc/terms/" property="dct:title">El Baúl del Programador</span> by <a xmlns:cc="http://creativecommons.org/ns#" href="http://www.elbauldelprogramador.com/"  property="cc:attributionName" rel="cc:attributionURL">Alejandro Alcalde</a> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/deed.es_ES" onclick="javascript:_gaq.push(['_trackEvent','outbound-widget','http://creativecommons.org/licenses/by-nc-sa/3.0/deed.es_ES']);">Creative Commons Reconocimiento-NoComercial-CompartirIgual 3.0 Unported License</a>.</></div> </aside></section> <footer id="colophon" role="contentinfo" class="span12"><div id="page-footer" class="well clearfix"> <span class="credits alignleft">&copy; 2012 <a href="http://www.elbauldelprogramador.com/">El Baúl del Programador</a>, all rights reserved.</span><div id="site-generator"> <a href="http://wordpress.org/" title="Semantic Personal Publishing Platform" target="_blank" rel="generator">Proudly powered by WordPress</a></div></div> </footer></div></div> <script type='text/javascript' src='http://s.gravatar.com/js/gprofiles.js?ver=2012Octaa'></script><script type='text/javascript'>var WPGroHo={"my_hash":""};</script><script type='text/javascript' src='http://www.elbauldelprogramador.com/wp-content/plugins/jetpack/modules/wpgroho.js?ver=6986'></script><div style="display:none"><div class="grofile-hash-map-08895492876c3a8160011ac0ef0c3d1c"></div><div class="grofile-hash-map-66435fd40825154e63251dfb01ffb25e"></div><div class="grofile-hash-map-08895492876c3a8160011ac0ef0c3d1c"></div></div><script type='text/javascript' src='http://www.elbauldelprogramador.com/wp-content/plugins/jetpack/modules/sharedaddy/sharing.js?ver=20120131'></script><script type="text/javascript" charset="utf-8">jQuery(document).ready(function(){jQuery('.share-twitter').click(function(){window.open(jQuery(this).attr('href'),'wpcomtwitter','menubar=1,resizable=1,width=600,height=350');return false;});});</script><script type="text/javascript" charset="utf-8">jQuery(document).ready(function(){jQuery('.share-facebook').click(function(){window.open(jQuery(this).attr('href'),'wpcomfacebook','menubar=1,resizable=1,width=600,height=400');return false;});});</script><script type="text/javascript" charset="utf-8">function sharing_plusone(obj){jQuery.ajax({url:'http://www.elbauldelprogramador.com/noticias/linux/20-ejemplos-de-iptables-para-sysadmins/?share=google-plus-1',type:'POST',data:obj});}</script><script type="text/javascript" src="http://apis.google.com/js/plusone.js"></script><script type="text/javascript" src="//platform.linkedin.com/in.js"></script><script type='text/javascript' src='http://s0.wp.com/wp-content/js/devicepx-jetpack.js?ver=201242'></script><script type='text/javascript' src='http://www.elbauldelprogramador.com/wp-content/themes/the-bootstrap/js/bootstrap.min.js?ver=2.0.3'></script><script type='text/javascript' src='http://www.elbauldelprogramador.com/wp-content/themes/the-bootstrap/js/the-bootstrap.min.js?ver=6986'></script><script type='text/javascript' src='http://www.elbauldelprogramador.com/wp-includes/js/comment-reply.js?ver=6986'></script><script src="http://stats.wordpress.com/e-201242.js" type="text/javascript"></script><script type="text/javascript">st_go({v:'ext',j:'1:1.8.1',blog:'34371135',post:'314'});var load_cmc=function(){linktracker_init(34371135,314,2);};if(typeof addLoadEvent!='undefined')addLoadEvent(load_cmc);else load_cmc();</script><style type='text/css'>img#wpstats{display:none}</style></body></html>
<!-- Performance optimized by W3 Total Cache. Learn more: http://www.w3-edge.com/wordpress-plugins/

Minified using disk: basic
Page Caching using disk: enhanced
Database Caching 1/72 queries in 0.471 seconds using disk: basic
Object Caching 1575/1797 objects using disk: basic

Served from: www.elbauldelprogramador.com @ 2012-10-16 10:28:30 -->