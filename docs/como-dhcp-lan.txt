

















Ingresar | Registrarse | Enviar_Nota
[Alcance_Libre]
Twitter Google+ Descargas Servicios
    * Portada
    * Foros
    * Manuales
    * Servicios
    * Cursos_Linux
 [Buscar...           ]
 [Buscar]
                                               Diciembre,_enero_y_febrero,_Curso_Global_de_Servidores_con_CentOS_6.
                                              Disponible_ALDOS_1.4.4._Nuestro_sistema_operativo_para_escritorio.
                                              ***** Configuración de servidor DHCP. *****
                                                   Autor: Joel Barrios Dueñas
                                                   Correo electrónico: darkshram_en_gmail_punto_com
                                                   Sitio de Red: http://www.alcancelibre.org/
                                                   Jabber ID: darkshram@jabber.org
                                              Creative Commons Reconocimiento-NoComercial-CompartirIgual_2.1
                                                   © 1999-2012 Joel Barrios Dueñas. Usted es libre de copiar, distribuir y
                                                   comunicar, públicamente la obra y hacer obras derivadas bajo las
                                                   condiciones siguientes: a) Debe reconocer y citar al autor original. b)
                                                   No puede utilizar esta obra para fines comerciales (incluyendo su
                                                   publicación, a través de cualquier medio, por entidades con fines de
                                                   lucro). c) Si altera o transforma esta obra o genera una obra derivada,
                                                   sólo puede distribuir la obra generada bajo una licencia idéntica a
                                                   ésta. Al reutilizar o distribuir la obra, tiene que dejar bien claro los
                                                   términos de la licencia de esta obra. Alguna de estas condiciones puede
                                                   no aplicarse si se obtiene el permiso del titular de los derechos de
                                                   autor. Los derechos derivados de usos legítimos u otras limitaciones no
                                                   se ven afectados por lo anterior. Licencia completa en castellano. La
                                                   información contenida en este documento y los derivados de éste, se
                                                   proporcionan tal cual son y los autores no asumirán responsabilidad
                                                   alguna si el usuario o lector, hace mal uso de éstos. Esta licencia
                                                   deberá aparecer como primer texto del documento distribuido
                                              ***** Introducción. *****
                                              **** Acerca del protocolo DHCP. ****
                                              DHCP (acrónimo de Dynamic Host Configuration Protocol, que se traduce Protocolo de
                                              configuración dinámica de servidores) es un protocolo que permite a dispositivos
                                              individuales en una red de direcciones IP obtener su propia información de
                                              configuración de red (dirección IP; máscara de sub-red, puerta de enlace, etc.) a
                                              partir de un servidor DHCP. Su propósito principal es hacer más fáciles de
                                              administrar las redes grandes. DHCP existe desde 1993 como protocolo estándar y se
                                              describe a detalle en el RFC_2131.
                                              Sin la ayuda de un servidor DHCP, tendrían que configurarse de forma manual cada
                                              dirección IP de cada anfitrión que pertenezca a una Red de Área Local. Si un
                                              anfitrión se traslada hacia otra ubicación donde existe otra Red de Área Local, se
                                              tendrá que configurar otra dirección IP diferente para poder unirse a esta nueva
                                              Red de Área Local. Un servidor DHCP entonces supervisa y distribuye, las
                                              direcciones IP de una Red de Área Local asignando una dirección IP a cada
                                              anfitrión que se una a la Red de Área Local. Cuando, por mencionar un ejemplo, una
                                              computadora portátil se configura para utilizar DHCP, a ésta le será asignada una
                                              dirección IP y otros parámetros de red, necesarios para unirse a cada Red de Área
                                              Local donde se localice.
                                              Existen tres métodos de asignación en el protocolo DHCP:
                                              Asignación manual: La asignación utiliza una tabla con direcciones MAC (acrónimo
                                              de Media Access Control Address, que se traduce como dirección de Control de
                                              Acceso al Medio). Sólo los anfitriones con una dirección MAC definida en dicha
                                              tabla recibirá el IP asignada en la misma tabla. Ésto se hace a través del
                                              parámetro hardware ethernet combinado con deny unknown-clients.
                                              Asignación automática: Una dirección de IP disponible dentro de un rango
                                              determinado se asigna permanentemente al anfitrión que la requiera.
                                              Asignación dinámica: Se determina arbitrariamente un rango de direcciones IP y
                                              cada anfitrión conectado a la red está configurada para solicitar su dirección IP
                                              al servidor cuando se inicia el dispositivo de red, utilizando un intervalo de
                                              tiempo controlable (parámetros default-lease-time y max-lease-time), de modo que
                                              la asignación de direcciones IP es de manera temporal y éstas se reutilizan de
                                              forma dinámica.
                                              URL: http://www.ietf.org/rfc/rfc2131.txt y http://www.ietf.org/rfc/rfc2132.txt
                                              **** Acerca de dhcp por Internet Software Consortium, Inc. ****
                                              Fundado en 1994, Internet Software Consortium, Inc., distribuye un conjunto de
                                              herramientas para el protocolo DHCP, las cuales consisten en:
                                              Servidor DHCP.
                                              Cliente DHCP.
                                              Agente de retransmisión.
                                              Dichas herramientas utilizan un API (Application Programming Interface o Interfaz
                                              de Programación de Aplicaciones) modular diseñado para ser lo suficientemente
                                              general para ser utilizado con facilidad en los sistemas operativos que cumplen el
                                              estándar POSIX (Portable Operating System Interface for UNIX o interfaz portable
                                              de sistema operativo para Unix) y no-POSIX, como Windows.
                                              URL: http://isc.org/products/DHCP/
                                              ***** Equipamiento lógico necesario. *****
                                              **** CentOS, Fedora™ y Red Hat™ Enterprise Linux. ****
                                              Ejecute lo siguiente para instalar o actualizar todo necesario:
                                                                             yum -y install dhcp
                                              ***** Modificaciones necesarias en el muro cortafuegos. *****
                                              Por lo general, jamás se abren puertos de DHCP a las redes públicas. Si se utiliza
                                              un cortafuegos con políticas estrictas, como por ejemplo Shorewall, es necesario
                                              abrir los puerto 67 y 68, por UDP (BOOTPS y BOOTPC, respectivamente) de modo
                                              bidireccional.
                                              *** Servicio iptables. ***
                                              Asumiendo que el servicio funcionará a través de la interfaz eth1, si lo prefiere,
                                              puede utilizar directamente el mandato iptables, ejecutando lo siguiente:
                                                        iptables -A INPUT -i eth1 -p udp -m state --state NEW -m udp \
                                                            --sport 67:68 --dport 67:68 -j ACCEPT

                                                        service iptables save
                                              O bien edite el archivo /etc/sysconfig/iptables:
                                                                         vim /etc/sysconfig/iptables
                                              Y añada el siguiente contenido:
                                              -A INPUT -i eth1 -p udp -m state --state NEW -m udp --sport 67:68 --dport 67:68 -
                                              j ACCEPT
                                              Reinicie el servicio iptables a fin de que surtan efecto los cambios.
                                                                           service iptables restart
                                              *** Shorewall. ***
                                              Edite el archivo /etc/shorewall/interfaces:
                                                                        vim /etc/shorewall/interfaces
                                              Asumiendo que el servicio funcionará a través de la interfaz eth1 (zona loc),
                                              añada la opción dhcp a las opciones de la interfaz sobre la cual funciona el
                                              servicio dhcpd. Esta opción, tras reiniciar el servicio shorewall, habilita las
                                              comunicaciones de entrada y salida, para DHCP.
                                                  ##########################################################################
                                                  #ZONE   INTERFACE       BROADCAST       OPTIONS
                                                  net	eth0		detect		blacklist
                                                  loc	eth1		detect		dhcp,blacklist
                                                  #LAST LINE -- ADD YOUR ENTRIES BEFORE THIS ONE -- DO NOT REMOVE
                                              Reinicie el servicio shorewall a fin de que surtan efecto los cambios.
                                                                          service shorewall restart
                                              ***** SELinux y el servicio dhcpd. *****
                                              Se recomienda encarecidamente dejar activo SELinux y dejar como están las
                                              políticas predeterminadas.
                                              [/images/notas24x24.png]Nota.
                                              Lo siguiente sólo aplica para CentOS 5 y Red Hat Enterprise Linux 5.
                                              Si se desea eliminar la protección que brinda SELinux al servicio dhcpd, utilice
                                              el siguiente mandato.
                                                                     setsebool -P dhcpd_disable_trans 1
                                              Si se desea eliminar la protección que brinda SELinux al sistema para funcionar
                                              como cliente DHCP, utilice el siguiente mandato.
                                                                     setsebool -P dhcpc_disable_trans 1
                                              Ninguna de estás políticas existe en CentOS 6 y Red Hat Enterprise Linux 6.
                                              ***** Iniciar, detener y reiniciar, el servicio dhcpd. *****
                                              Para hacer que el servicio de dhcpd esté activo con el siguiente inicio del
                                              sistema, en todos los niveles de ejecución (2, 3, 4 y 5), ejecute lo siguiente:
                                                                              chkconfig dhcpd on
                                              Para iniciar por primera vez el servicio dhcpd, utilice:
                                                                             service dhcpd start
                                              Para hacer que los cambios hechos a la configuración del servicio dhcpd surtan
                                              efecto, utilice:
                                                                            service dhcpd restart
                                              Para detener el servicio dhcpd, utilice:
                                                                              service dhcpd stop
                                              ***** Procedimientos. *****
                                              **** Archivo de configuración /etc/sysconfig/dhcpd. ****
                                              En el caso de disponer múltiples dispositivos de red en el servidor, se recomienda
                                              que el servicio dhcpd solamente funcione a través de la interfaz de red utilizada
                                              por la LAN. Edite el archivo /etc/sysconfig/dhcpd y agregue el valor eth0, eth1,
                                              eth2, etc., como argumento(s) del parámetro DHCPDARGS o bien lo que corresponda a
                                              la interfaz desde la cual accede la red local.
                                              Edite el archivo /etc/sysconfig/dhcpd:
                                                                           vim /etc/sysconfig/dhcpd
                                              Para el siguiente ejemplo, considerando que eth1 es la interfaz correspondiente a
                                              la LAN:
                                                                         # Command line options here
                                                                         DHCPDARGS=eth1
                                              **** Archivo de configuración dhcpd.conf. ****
                                              Considerando como ejemplo que se tiene una red local con las siguientes
                                              características:
                                              Dirección IP del segmento de red: 172.16.1.0
                                              Dirección IP de difusión: 172.16.1.63
                                              Máscara de sub-red: 255.255.255.192 (26 bit)
                                              Puerta de enlace: 172.16.1.1
                                              Servidor de nombres: 172.16.1.1
                                              Servidor Wins: 172.16.1.1
                                              Servidores de tiempo (NTP): recomendamos utilizar los de NTP.org &mdash;es decir
                                              0.pool.ntp.org, 1.pool.ntp.org, 2.pool.ntp.org y 3.pool.ntp.org&mdash; los cuales
                                              son confiables y de acceso gratuito.
                                              Rango de direcciones IP a asignar de modo dinámico: 172.16.1.2, hasta 172.16.1.58.
                                              Direcciones IP que serán asignadas a dispositivos con IP fija (172.16.1.59,
                                              172.16.1.60, 172.16.1.61 y 172.16.1.14).
                                               [/images/notas24x24.png]Nota.
                                               Es indispensable conocer y entender perfectamente, todo lo anterior para poder
                                               continuar con este documento. Si se tienen dudas, por favor, primero consultar y
                                               estudiar, el documento titulado «Introducción_a_IP_versión_4.»
                                              Puede utilizar el contenido de ejemplo, que se encuentra más adelante, para
                                              adaptar o bien crear desde cero, un nuevo archivo de configuración para el
                                              servicio dhcpd, ajustando los datos a una red para un conjunto de sistemas en
                                              particular.
                                              **** Configuración básica. ****
                                              Descargue el archivo plantilla, con una configuración mínima recomendada, desde
                                              AlcanceLibre.org, ejecutando lo siguiente:
                                                          cd /etc/dhcp/
                                                          mv dhcpd.conf dhcpd.conf.original
                                                          wget http://www.alcancelibre.org/linux/secrets/dhcpd.conf
                                                          restorecon dhcpd.conf
                                                          cd
                                              Si se utiliza CentOS 6 o Red Hat Enterprise Linux 6, edite el archivo /etc/dhcp/
                                              dhcpd.conf.
                                                                           vim /etc/dhcp/dhcpd.conf

                                                 [/images/notas24x24.png]Nota.
                                                 Si se utiliza CentOS 5 o Red Hat Enterprise Linux 5, edite el archivo /etc/
                                                 dhcpd.conf.
                                                                             vim /etc/dhcpd.conf
                                              Para efectos prácticos, utilice la siguiente plantilla y modifique todo lo que
                                              esté resaltado.
                                              # Si se tienen problemas con equipos con Windows Vista/7/8 omita el parámetro
                                              # server-identifier. Ésto aunque rompe con el protocolo DHCP, permite a los
                                              # clientes Windows Vista/7/8 poder comunicarse con el servidor DHCP y aceptar
                                              # la dirección IP proporcionada.
                                              # server-identifier 172.16.1.1;
                                              ddns-update-style interim;
                                              ignore client-updates;
                                              authoritative;
                                              default-lease-time 900;
                                              max-lease-time 7200;
                                              option ip-forwarding off;
                                              option domain-name &quot;red-local.net&quot;;
                                              option ntp-servers 0.pool.ntp.org, 1.pool.ntp.org, 2.pool.ntp.org, 3.pool.ntp.org;

                                              shared-network redlocal {
                                              	subnet 172.16.1.0 netmask 255.255.255.192 {
                                              		option routers 172.16.1.1;
                                              		option subnet-mask 255.255.255.192;
                                              		option broadcast-address 172.16.1.63;
                                              		option domain-name-servers 172.16.1.1;
                                              		option netbios-name-servers 172.16.1.1;
                                              		range 172.16.1.2 172.16.1.58;
                                              	}
                                              }
                                              Lo anterior corresponde a la configuración básica recomendada para un servidor
                                              DHCP básico.
                                              Una vez terminada la configuración, para iniciar el servicio ejecute lo siguiente:
                                                                             service dhcpd start
                                              **** Asignación de direcciones IP estáticas. ****
                                              Para definir equipos con direcciones IP estáticas, pueden añadirse también en la
                                              configuración de la siguiente forma, especificando el nombre de anfitrión,
                                              dirección MAC y dirección IP:
                                                                 host impresora {
                                                                 		option host-name "epl5900.red-local.net";
                                                                 		hardware ethernet 00:24:2B:65:54:84;
                                                                 		fixed-address 172.16.1.59;
                                                                 		}
                                              Edite el archivo /etc/dhcp/dhcpd.conf o bien /etc/dhcpd.conf, según corresponda:
                                                                           vim /etc/dhcp/dhcpd.conf
                                              Un ejemplo de la configuración quedaría del siguiente modo:
                                              # Si se tienen problemas con equipos con Windows Vista/7/8 omita el parámetro
                                              # server-identifier. Ésto aunque rompe con el protocolo DHCP, permite a los
                                              # clientes Windows Vista/7/8 poder comunicarse con el servidor DHCP y aceptar
                                              # la dirección IP proporcionada.
                                              # server-identifier 172.16.1.1;
                                              ddns-update-style interim;
                                              ignore client-updates;
                                              authoritative;
                                              default-lease-time 900;
                                              max-lease-time 7200;
                                              option ip-forwarding off;
                                              option domain-name &quot;red-local.net&quot;;
                                              option ntp-servers 0.pool.ntp.org, 1.pool.ntp.org, 2.pool.ntp.org, 3.pool.ntp.org;

                                              shared-network redlocal {
                                              	subnet 172.16.1.0 netmask 255.255.255.192 {
                                              		option routers 172.16.1.1;
                                              		option subnet-mask 255.255.255.192;
                                              		option broadcast-address 172.16.1.63;
                                              		option domain-name-servers 172.16.1.1;
                                              		option netbios-name-servers 172.16.1.1;
                                              		range 172.16.1.2 172.16.1.58;
                                              	}
                                              # Equipos con IP fija.
                                              	host impresora {
                                              		option host-name "epl5900.red-local.net";
                                              		hardware ethernet 00:24:2B:65:54:84;
                                              		fixed-address 172.16.1.59;
                                              		}
                                              	host pc14 {
                                              		option host-name "pc14.red-local.net";
                                              		hardware ethernet 00:50:BF:27:1C:1C;
                                              		fixed-address 172.16.1.60;
                                              		}
                                              }
                                              Si realizó cambios en la configuración, reinicie el servicio dhcpd a fin de que
                                              surtan efecto los cambios.
                                                                            service dhcpd restart
                                              **** Limitar el acceso por dirección MAC. ****
                                              Es posible limitar el acceso al servidor DHCP a través de la opción deny con el
                                              valor unknown-clients y definiendo una lista de direcciones MAC. De tal modo, a
                                              los anfitriones que estén ausentes en dicha lista les será denegado el servicio.
                                              Ejemplo:
                                                                   deny unknown-clients;
                                                                   		host impresora {
                                                                   			hardware ethernet 00:24:2B:65:54:84;
                                                                   		}
                                                                   		host pc1 {
                                                                   			hardware ethernet 00:50:BF:27:1C:1C;
                                                                   		}
                                              Edite el archivo /etc/dhcp/dhcpd.conf o bien /etc/dhcpd.conf, según corresponda:
                                                                           vim /etc/dhcp/dhcpd.conf
                                              Un ejemplo de la configuración quedaría del siguiente modo, donde sólo las
                                              direcciones MAC en la lista pueden conectarse hacia el servidor DHCP y recibir una
                                              dirección IP:
                                              # Si se tienen problemas con equipos con Windows Vista/7/8 omita el parámetro
                                              # server-identifier. Ésto aunque rompe con el protocolo DHCP, permite a los
                                              # clientes Windows Vista/7/8 poder comunicarse con el servidor DHCP y aceptar
                                              # la dirección IP proporcionada.
                                              # server-identifier 172.16.1.1;
                                              ddns-update-style interim;
                                              ignore client-updates;
                                              authoritative;
                                              default-lease-time 900;
                                              max-lease-time 7200;
                                              option ip-forwarding off;
                                              option domain-name &quot;red-local.net&quot;;
                                              option ntp-servers 0.pool.ntp.org, 1.pool.ntp.org, 2.pool.ntp.org, 3.pool.ntp.org;

                                              shared-network redlocal {
                                              	subnet 172.16.1.0 netmask 255.255.255.192 {
                                              		option routers 172.16.1.1;
                                              		option subnet-mask 255.255.255.192;
                                              		option broadcast-address 172.16.1.63;
                                              		option domain-name-servers 172.16.1.1;
                                              		option netbios-name-servers 172.16.1.1;
                                              		range 172.16.1.2 172.16.1.58;
                                              	}
                                              # Lista de direcciones MAC que tendrán permitido utilizar el servidor
                                              # DHCP.
                                              # deny unknown-clients impide que equipos fuera de esta lista puedan
                                              # utilizar el servicio.
                                              		deny unknown-clients;
***** Sondeo *****                            		host impresora {
Si ya probaste GNOME 3...                     			hardware ethernet 00:24:2B:65:54:84;
¿Te gustó GNOME 3?                          		}
    * o Si                                   		host pc1 {
    * o No                                   			hardware ethernet 00:50:BF:27:1C:1C;
Este sondeo tiene 5 preguntas más.           		}
[Iniciar Sondeo] Resultados                   		host pc2 {
 Más_sondeos | 16,334 votos | 9_comentarios  			hardware ethernet F4:C7:14:70:FA:AC;
                                              		}
                                              		host laptop1 {
                                              			hardware ethernet 44:87:FC:AA:DD:2D;
                                              		}
                                              		host laptop2 {
                                              			hardware ethernet 70:F1:A1:9F:70:3B;
                                              		}
                                              }
                                              Si realizó cambios en la configuración, reinicie el servicio dhcpd a fin de que
                                              surtan efecto los cambios.
                                                                            service dhcpd restart
                                              **** Configuración para funcionar con DNS dinámico. ****
                                              El servidor DNS puede funcionar de modo dinámico permitiendo la actualización en
                                              tiempo real de los nombres de anfitrión y las direcciones IP asociadas a éstos, a
                                              través de la información enviada a través de un servidor DHCP.
                                              Añada la firma digital del servidor DNS al archivo de configuración del servidor
                                              DHCP:
                                                                  cat /etc/rndc.key >> /etc/dhcp/dhcpd.conf
                                              Edite el archivo /etc/dhcp/dhcpd.conf:
                                                                           vim /etc/dhcp/dhcpd.conf
                                              Asumiendo que ya se dispone de un servidor_DNS_previamente_configurado_y
                                              funcionando, para configurar el servidor DHCP a fin de que actualice
                                              automáticamente los registros correspondientes en las zonas del servidor DNS, sólo
                                              basta añadir los parámetros ddns-updates, ddns-domainname, ddns-rev-domainname, la
                                              misma firma digital de la configuración del DNS y definir las zonas de localhost,
                                              zona de re-envío y zona de resolución inversa del DNS, con los valores
                                              ejemplificados a continuación, solamente siendo necesario reemplazar los valores
                                              resaltados.
                                              # Si se tienen problemas con equipos con Windows Vista/7/8 omita el parámetro
                                              # server-identifier. Ésto aunque rompe con el protocolo DHCP, permite a los
                                              # clientes Windows Vista/7/8 poder comunicarse con el servidor DHCP y aceptar
                                              # la dirección IP proporcionada.
                                              # server-identifier 172.16.1.1;
                                              ddns-update-style interim;
                                              ddns-updates on;
                                              ddns-domainname "red-local.net.";
                                              ddns-rev-domainname "in-addr.arpa.";
                                              ignore client-updates;
                                              authoritative;
                                              default-lease-time 900;
                                              max-lease-time 7200;
                                              option ip-forwarding off;
                                              option domain-name &quot;red-local.net&quot;;
                                              option ntp-servers 0.pool.ntp.org, 1.pool.ntp.org, 2.pool.ntp.org, 3.pool.ntp.org;

                                              # Copiar tal cual contenido del archivo
                                              # /etc/rndc.key
                                              # Ésto se utilizará para poder comunicar el servidor DHCP con el servidor DNS,
                                              # y poder gestionar zonas dinámicas desde el servidor DHCP con la misma firma
                                              # digital.
                                              # Jamás utilizar la clave ejemplificada a continuación para producción.
                                              # Es la única configuración cuya llave de cierre pueden llevar punto y coma.
                                              key &quot;rndc-key&quot; {
                                              	algorithm hmac-md5;
                                              	secret "undGpjMq3iWmUh2yvWOnUQ==";
                                              };

                                              zone localdomain. {
                                              	primary 127.0.0.1;
                                              	key rndc-key;
                                              }

                                              zone  1.16.172.in-addr.arpa. {
                                              	primary 172.16.1.1;
                                              	key rndc-key;
                                              }
                                              zone red-local.net. {
                                              	primary 172.16.1.1;
                                              	key rndc-key;
                                              }

                                              shared-network redlocal {
                                              	subnet 172.16.1.0 netmask 255.255.255.192 {
                                              		option routers 172.16.1.1;
                                              		option subnet-mask 255.255.255.192;
                                              		option broadcast-address 172.16.1.63;
                                              		option domain-name-servers 172.16.1.1;
                                              		option netbios-name-servers 172.16.1.1;
                                              		range 172.16.1.2 172.16.1.58;
                                              	}
                                              }
                                              Para que lo anterior funcione con el servidor DNS, considerando que ya están
                                              instalados los paquetes bind y bind-chroot, se requiere generar los archivos red-
                                              local.net.zone y 1.16.172.in-addr.arpa.zone, dentro del directorio /var/named/
                                              chroot/dynamic/. Cambie al directorio /var/named/chroot/dynamic/:
                                                                   cd /var/named/chroot/var/named/dynamic/
                                              Utilice el mandato touch para crear los archivos red-local.net.zone y 1.16.172.in-
                                              addr.arpa.zone:
                                                                       touch red-local.net.zone
                                                                       touch 1.16.172.in-addr.arpa.zone
                                              Ambos archivos deben tener permisos de lectura y escritura para usuario y sólo
                                              lectura para grupo:
                                                                     chmod 640 red-local.net.zone
                                                                     chmod 640 1.16.172.in-addr.arpa.zone
                                              Ambos archivos deben pertenecer al usuario named y grupo named.
                                                                 chown named:named red-local.net.zone
                                                                 chown named:named 1.16.172.in-addr.arpa.zone
                                              Edite el archivo /var/named/chroot/var/named/dynamic/red-local.net.zone:
                                                                            vim red-local.net.zone
                                              Éste deberá tener el siguiente contenido, donde solamente será necesario añadir al
                                              ejemplo los registros de los equipos con IP fija:
                                                                       $TTL 86400
                                                                       @	IN	SOA	servidor.red-local.net.
                                                                       root.localhost. (
                                                                       			2011101901;
                                                                       			28800;
                                                                       			7200;
                                                                       			604800;
                                                                       			86400;
                                                                       			)
                                                                       @		IN	NS	servidor.red-local.net.
                                                                       servidor
                                                                       IN	A	172.16.1.1
                                              Edite el archivo /var/named/chroot/var/named/dynamic/1.16.172.in-addr.arpa.zone:
                                                                        vim 1.16.172.in-addr.arpa.zone
                                              Éste deberá tener el siguiente contenido, donde solamente será necesario añadir al
                                              ejemplo los registros de los equipos con IP fija:
                                                                       $TTL 86400
                                                                       @	IN	SOA	servidor.red-local.net.
                                                                       root.localhost. (
                                                                       			2011101901;
                                                                       			28800;
                                                                       			7200;
                                                                       			604800;
                                                                       			86400;
                                                                       			)
                                                                       @		IN	NS	servidor.red-local.net.
                                                                       1
                                                                       IN	PTR	servidor.red-local.net.
                                              Cambie al directorio /var/named/chroot/etc/:
                                                                          cd /var/named/chroot/etc/
                                              Edite el archivo /var/named/chroot/etc/named.conf:
                                                                                vim named.conf
                                              Éste deberá tener un contenido similar al siguiente:
                                               options {
                                               	directory &quot;/var/named&quot;;
                                               	dump-file &quot;/var/named/data/cache_dump.db&quot;;
                                               	statistics-file &quot;/var/named/data/named_stats.txt&quot;;
                                               	memstatistics-file &quot;/var/named/data/named_mem_stats.txt&quot;;
                                               	forwarders {
                                               		8.8.8.8;
                                               		8.8.4.4;
                                               	};
                                               	forward first;
                                               // Opciones de DNSSEC.
                                               //	dnssec-enable yes;
                                               //	dnssec-validation yes;
                                               //	dnssec-lookaside auto;
                                               //	bindkeys-file &quot;/etc/named.iscdlv.key&quot;;
                                               };

                                               include &quot;/etc/rndc.key&quot;;

                                               logging {
                                               	channel default_debug {
                                               		file &quot;data/named.run&quot;;
                                               		severity dynamic;
                                               	};
                                               };

                                               controls {
                                               	inet 127.0.0.1 allow { 127.0.0.1; 172.16.1.1; } keys { &quot;rndc-key&quot;; };
                                               };

                                               view &quot;local&quot; {
                                               	match-clients { 127.0.0.0/8; 172.16.1.0/26; };
                                               	recursion yes;
                                               	include &quot;/etc/named.rfc1912.zones&quot;;
                                               	zone &quot;.&quot; IN {
                                               		type hint;
                                               		file &quot;named.ca&quot;;
                                               	};
                                               	zone &quot;red-local.net&quot; {
                                               		type master;
                                               		file &quot;dynamic/red-local.net.zone&quot;;
                                               		allow-update { key &quot;rndc-key"; };
                                               	};
                                               	zone &quot;1.16.172.in-addr.arpa&quot; {
                                               		type master;
                                               		file &quot;dynamic/1.16.172.in-addr.arpa.zone&quot;;
                                               		allow-update { key &quot;rndc-key"; };
                                               	};
                                               };

                                               view &quot;public&quot; {
                                                       match-clients { any; };
                                                       recursion no;
                                                       zone &quot;.&quot; IN {
                                                               type hint;
                                                               file &quot;named.ca&quot;;
                                                       };
                                               };
                                              Regrese al directorio de inicio.
                                                                                      cd
                                              Active la política de SELinux, la cual permitirá al servidor DNS poder realizar
                                              modificaciones a los archivos de zona.
                                                                   setsebool -P named_write_master_zones 1
                                              Reinicie el servicio named a fin de que surtan efecto los cambios.
                                                                            service named restart
                                              Reinicie también el servicio dhcpd a fin de que surtan efecto los cambios y para
                                              que el servidor DHCP comience a interactuar con el servidor DNS.
                                                                            service dhcpd restart
                                              A partir de este momento, todo cliente que tenga definido en su configuración
                                              local un nombre de anfitrión y al cual le sea asignada una dirección IP a través
                                              del servidor DHCP recién configurado, comunicará su nombre de anfitrión al
                                              servidor DHCP, el cual a su vez comunicará al servidor DNS este mismo nombre
                                              asociada a la dirección IP asignada al cliente, de modo que el DNS añadirá
                                              automáticamente el registro correspondiente a las zonas de re-envío y de
                                              resolución inversa correspondientes.
                                              Verifique que el servidor DNS dinámico funciona correctamente, simulando lo que en
                                              adelante hará automáticamente en segundo plano el servidor DHCP, añadiendo un par
                                              de registros a través del mandato nsupdate. Ejecute lo siguiente para conectarse
                                              al servidor DNS utilizando la firma digital que utilizarán tanto el éste como el
                                              servidor DHCP:
                                                                          nsupdate -k /etc/rndc.key
                                              Desde el intérprete de mandatos de nsupdate, ejecute lo siguiente:
                                                     server 127.0.0.1
                                                     update add prueba.red-local.net. 86400 A 172.16.1.14
                                                     send
                                                     update add 14.1.16.172.in-addr.arpa. 86400 PTR prueba.red-local-net
                                                     send
                                                     quit
                                              Si lo anterior devuelve errores como el siguiente:
                                                                            update failed: REFUSED
                                              Significa que hay errores en el procedimiento realizado o la configuración o bien
                                              que la firma digital utilizada en el archivo /etc/named.conf es distinta a la del
                                              archivo /etc/rndc.key.
                                              Si lo anterior devuelve errores como el siguiente:
                                                                ; TSIG error with server: tsig indicates error
                                                                update failed: REFUSED(BADKEY)
                                              Significa que el nombre de anfitrión pertenece a un dominio distinto al
                                              configurado o bien la dirección IP pertenece a otro bloque direcciones distinto al
                                              configurado. Corrija lo necesario si así es el caso.
                                              Si el procedimiento concluyó sin errores, haga consultas al servidor DNS para
                                              prueba.red-local.net y 172.16.1.14 para cotejar que el servidor DNS aceptó los dos
                                              registros añadidos a través de nsupdate, ejecutando lo siguiente:
                                                                          host prueba.red-local.net
                                                                          host 172.16.1.14
                                              Lo anterior debe devolver una salida similar a la siguiente:
                                                      [root@servidor ~]# host prueba.red-local.net
                                                      prueba.red-local.net has address 172.16.1.14
                                                      [root@servidor ~]# host 172.16.1.14
                                                      14.1.16.172.in-addr.arpa domain name pointer prueba.red-local.net.
                                              Si la salida devuelve errores, significa que hay errores en el procedimiento
                                              realizado o bien el dominio y zona de resolución inversa son diferentes a los
                                              configurados. Corrija lo necesario si así es el caso.
                                              Si el procedimiento concluyó correctamente, utilice el mandato nsupdate para
                                              conectarse de nuevo al servidor DNS ejecutando lo siguiente:
                                                                          nsupdate -k /etc/rndc.key
                                              Desde el intérprete de mandatos de nsupdate, ejecute lo siguiente para eliminar
                                              los registros:
                                                                 server 127.0.0.1
                                                                 update delete prueba.red-local.net. A
                                                                 send
                                                                 update delete 14.1.16.172.in-addr.arpa. PTR
                                                                 send
                                                                 quit
                                              Esta es, por cierto, la metodología recomendada para añadir o eliminar registros
                                              de zonas en el servidor DNS cuando se utilizan zonas dinámicas.
                                              ***** Comprobaciones desde cliente DHCP. *****
                                              Hecho lo anterior, solamente se necesitará configurar como interfaces DHCP, las
                                              utilizadas en las estaciones de trabajo que sean necesarias, sin importar que
                                              sistema operativo utilicen.
                                              Después concluida la configuración y que estén funcionando los servicio
                                              correspondientes, pueden hacerse comprobaciones desde un cliente GNU/Linux, es
                                              decir, desde otro equipo. Abra una terminal, como usuario root y, asumiendo que se
                                              tiene una interfaz de red denominada eth0, utilice los siguientes mandatos para
                                              desactivar la interfaz eth0 y asignar una nueva dirección IP a través del servidor
                                              dhcp.
                                                              ifdown eth0
                                                              dhclient -d -I nombre-equipo -H nombre-equipo eth0
                                              Lo anterior deberá devolver el mensaje «Determinando la información IP para
                                              eth0...» y el símbolo de sistema. Para corroborar, utilice el mandato ifconfig
                                              para visualizar los dispositivos de red activos en el sistema. Pulse CTRL-C para
                                              terminar el programa.
                                              Si se dispone de varios servidores DHCP y se desea probar la configuración de
                                              alguno en particular, puede añadir la opción -V al mandato dhclient, definiendo
                                              como valor para esta opción, el mismo valor que fue asignado para el parámetro
                                              server-identifier, establecido en el archivo /etc/dhcp/dhcpd.conf del servidor
                                              correspondiente.
                                                       ifdown eth0
                                                       dhclient -d -I nombre-equipo -H nombre-equipo -V 172.16.1.1 eth0
                                              Edite el archivo /etc/sysconfig/network-scripts/ifcfg-eth0 o el que corresponda al
                                              dispositivo de red principal del sistema cliente:
                                                                vim /etc/sysconfig/network-scripts/ifcfg-eth0
                                              La configuración permanente del dispositivo de red, considerando como ejemplo la
                                              interfaz eth0 con dirección MAC 00:01:03:DC:67:23, solicitando los datos para los
                                              servidores DNS, puerta de enlace y servidores de tiempo, sería la siguiente:
                                                                         DEVICE=eth0
                                                                         ONBOOT=yes
                                                                         USERCTL=yes
                                                                         HWADDR=00:01:03:DC:67:23
                                                                         TYPE=Ethernet
                                                                         NM_CONTROLLED=no
                                                                         BOOTPROTO=dhcp
                                                                         DEFROUTE=yes
                                                                         PEERDNS=yes
                                                                         PEERROUTES=yes
                                                                         PEERNTP=yes
                                                                         DOMAIN=red-local.net
                                                                         DHCP_CLIENT_ID=nombre-equipo
                                                                         DHCP_HOSTNAME=nombre-equipo
                                              Si utiliza NM_CONTROLLED=yes, deje que el servicio NetworkManager se encargue por
                                              si solo de aplicar los cambios. Si utiliza NM_CONTROLLED=no, reinicie el servicio
                                              network a fin de que surtan efecto los cambios.
                                                                           service network restart
                                              Última Edición 22/09/2012, 20:40|249,458 Accesos [Ver_la_versión_para_imprimir]
***** Noticias Recientes *****
    * Curso_Global_de_Servidores_...
    * MIT_Inventor,_una_forma_sen...
    * Factura_Libre_CBB_con_sopor...
    * Liberado_Extdesk_con_ExtJs_...
    * Invitación_al_Hackmitin_2012
    * Amazon_le_cierra_la_cuenta_...
    * Disponible_ALDOS_1.4.4
    * Red_Hat_anuncia_su_visión_p...
***** Comentarios Recientes *****
    * MIT Inventor, una forma s...
    * >_[+186]
    * >_[+9]
    * [+4]
    * [+2]
***** Enlaces Recientes *****
    * *_3CXphone
    * Dezoft.com_Soluciones_TI
    * El_Rincón_de_Tux
    * Bitácora_Personal_de_.::K...
    * Gomezbjesus._Desarrollo,_...
    * Comunidad_Salud_Libre
    * Comunidad_de_Software_Libre
    * Geeklog_Hispano

[Sitio_creado_con_Geeklog]
[Licencia_CC]
 Derechos de autor © 2012 Alcance Libre
 Todas las marcas y logotipos mencionados en este sitio de Internet son
propiedad de sus respectivos dueños..
© 1999-2011 Joel Barrios Dueñas. Salvo que se indique lo contrario, todo el
contenido está disponible bajo los términos de la licencia Creative_Commons
Reconocimiento_2.5.
Visite nuestro Directorio_de_noticias y Delti.com.mx.
